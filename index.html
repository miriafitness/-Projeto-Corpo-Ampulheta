<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ‘ Projeto Ampulheta da MiriÃ£</title>

  <style>
    :root{
      --bg:#0b0c10;
      --panel:#12131a;
      --panel2:#171826;
      --card:#141522;
      --stroke:rgba(255,255,255,.08);
      --text:#f2f2f6;
      --muted:rgba(242,242,246,.68);
      --pink:#ff3f8e;
      --pink2:#ff69a8;
      --shadow:0 18px 45px rgba(0,0,0,.45);
      --radius:22px;
      --radius2:18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 50% 0%, rgba(255,63,142,.18), transparent 60%) , var(--bg);
      color:var(--text);
      padding-bottom:92px; /* espaÃ§o do menu inferior */
    }

    .wrap{max-width:900px;margin:0 auto;padding:16px 14px 18px}
    .top{
      display:flex; gap:14px; align-items:center;
      padding:14px 14px 16px;
      background: linear-gradient(180deg, rgba(255,63,142,.20), rgba(18,19,26,.0));
      border-bottom: 1px solid rgba(255,255,255,.06);
      border-radius:0 0 26px 26px;
    }
    .appicon{
      width:54px;height:54px;border-radius:18px;
      background: linear-gradient(135deg, rgba(255,63,142,1), rgba(255,120,170,1));
      display:grid;place-items:center;
      box-shadow: 0 10px 28px rgba(255,63,142,.25);
      flex:0 0 auto;
    }
    .appicon span{font-size:26px}
    .title h1{margin:0;font-size:20px;line-height:1.15}
    .title p{margin:4px 0 0;color:var(--muted);font-size:12.5px}

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
      border:1px solid var(--stroke);
      border-radius: var(--radius);
      padding:14px;
      box-shadow: var(--shadow);
      margin:14px 0;
    }
    .card h2{
      margin:0 0 10px;
      font-size:18px; display:flex; align-items:center; gap:10px;
    }
    .small{color:var(--muted); font-size:12.5px; line-height:1.35}
    .divider{height:1px;background:rgba(255,255,255,.08);margin:12px 0}

    /* Atalhos */
    .shortcuts{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
      margin-top:10px;
    }
    .shortcut{
      background: linear-gradient(135deg, rgba(255,63,142,.95), rgba(255,105,168,.95));
      color:#fff;
      border:none;
      border-radius: 18px;
      padding:14px 12px;
      font-weight:700;
      display:flex;align-items:center;justify-content:center;gap:10px;
      cursor:pointer;
      box-shadow: 0 14px 35px rgba(255,63,142,.20);
    }
    .shortcut.gray{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.10);
      color:var(--text);
      box-shadow:none;
    }
    .shortcut span{font-size:18px}

    /* Inputs */
    label{display:block;margin:10px 0 6px;color:var(--muted);font-size:12.5px}
    input, select, textarea{
      width:100%;
      padding:12px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(10,11,16,.55);
      color:var(--text);
      outline:none;
    }
    textarea{min-height:76px; resize:vertical}
    input:disabled{opacity:.7}

    .row{display:flex;gap:10px;flex-wrap:wrap}
    .row > div{flex:1;min-width:170px}

    .btns{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    button.btn{
      border:none; cursor:pointer;
      border-radius: 16px;
      padding:12px 14px;
      font-weight:800;
      background: linear-gradient(135deg, rgba(255,63,142,1), rgba(255,105,168,1));
      color:#fff;
    }
    button.btn.ghost{
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      color:var(--text);
      font-weight:700;
    }
    button.btn.danger{
      background: rgba(255,255,255,.05);
      border:1px dashed rgba(255,63,142,.8);
      color: var(--pink2);
      font-weight:800;
    }

    .kpis{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .kpi{
      flex:1; min-width:170px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      border-radius: 18px;
      padding:12px;
    }
    .kpi .t{color:var(--muted);font-size:12px}
    .kpi .v{font-size:22px;font-weight:900;margin-top:6px}
    .kpi .s{color:var(--muted);font-size:12px;margin-top:2px}

    .progress{height:14px;border-radius:999px;background:rgba(255,255,255,.08);overflow:hidden;margin-top:10px}
    .bar{height:100%;width:0%;background:linear-gradient(90deg,var(--pink),var(--pink2));transition:.25s}

    /* Lista / links */
    .list{margin-top:10px}
    .list a{color:var(--pink2);text-decoration:none}
    .list a:hover{text-decoration:underline}
    .chip{display:inline-block;padding:4px 9px;border-radius:999px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);color:var(--muted);font-size:12px;margin-right:6px}

    /* Tabs */
    .view{display:none}
    .view.active{display:block}

    /* Bottom Nav */
    .nav{
      position:fixed; left:0; right:0; bottom:0;
      background: rgba(12,12,18,.78);
      backdrop-filter: blur(14px);
      border-top:1px solid rgba(255,255,255,.08);
      padding:10px 10px 12px;
    }
    .nav .inner{max-width:900px;margin:0 auto;display:flex;gap:10px;justify-content:space-between}
    .tab{
      flex:1;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      color:var(--text);
      border-radius: 20px;
      padding:10px 8px;
      text-align:center;
      cursor:pointer;
      user-select:none;
    }
    .tab .ico{font-size:20px;display:block;margin-bottom:3px}
    .tab .lbl{font-size:12px;font-weight:800;opacity:.92}
    .tab.active{
      background: linear-gradient(135deg, rgba(255,63,142,.55), rgba(255,105,168,.28));
      border:1px solid rgba(255,63,142,.55);
      box-shadow: 0 14px 35px rgba(255,63,142,.16);
    }

    @media (min-width:700px){
      .shortcuts{grid-template-columns: repeat(3, minmax(0,1fr));}
    }
  </style>
</head>

<body>
  <div class="top">
    <div class="appicon"><span>ğŸ‘</span></div>
    <div class="title">
      <h1>Projeto Ampulheta da MiriÃ£</h1>
      <p>Treino + Ã¡gua + proteÃ­na + cintura + intestino + fotos â€¢ salva no seu celular</p>
    </div>
  </div>

  <div class="wrap">

    <!-- =================== INÃCIO =================== -->
    <section id="view-inicio" class="view active">

      <div class="card" id="sec-atalhos">
        <h2>âš¡ Atalhos</h2>
        <p class="small">Um toque e pronto âœ¨</p>

        <div class="shortcuts">
          <button class="shortcut" onclick="goTab('agua')"><span>ğŸ’§</span> Ãgua</button>
          <button class="shortcut" onclick="jumpTo('sec-proteina')"><span>ğŸ¥©</span> ProteÃ­na</button>
          <button class="shortcut" onclick="jumpTo('sec-intestino')"><span>ğŸš½</span> Intestino</button>
          <button class="shortcut" onclick="goTab('medidas')"><span>ğŸ“</span> Medidas</button>
          <button class="shortcut gray" onclick="jumpTo('sec-peito')"><span>ğŸ’—</span> Peito firme</button>
        </div>
      </div>

      <!-- RESUMO (mini KPIs) -->
      <div class="card">
        <h2>ğŸ“Œ Resumo de hoje</h2>
        <div class="kpis">
          <div class="kpi">
            <div class="t">ğŸ’§ Ãgua hoje</div>
            <div class="v" id="miniAgua">0 ml</div>
            <div class="s" id="miniAgua2">MÃ©dia 7 dias: 0 ml</div>
          </div>
          <div class="kpi">
            <div class="t">ğŸ¥© ProteÃ­na hoje</div>
            <div class="v" id="miniProt">0 g</div>
            <div class="s" id="miniProt2">Meta: 95 g</div>
          </div>
        </div>
        <div class="divider"></div>
        <div class="kpis">
          <div class="kpi">
            <div class="t">ğŸ‘ Ampulheta</div>
            <div class="v" id="miniAmp">--</div>
            <div class="s" id="miniAmp2">glÃºteo Ã· cintura</div>
          </div>
          <div class="kpi">
            <div class="t">ğŸš½ Intestino</div>
            <div class="v" id="miniInt">--</div>
            <div class="s" id="miniInt2">chia em jejum ajuda</div>
          </div>
        </div>
      </div>

      <!-- PROTEÃNA -->
      <div class="card" id="sec-proteina">
        <h2>ğŸ¥© ProteÃ­na (meta + automÃ¡tico)</h2>
        <p class="small">VocÃª digita a quantidade e o app calcula a proteÃ­na total sozinho âœ…</p>

        <div class="row">
          <div>
            <label>ğŸ¯ Meta de proteÃ­na (g/dia)</label>
            <input type="number" id="metaProt" value="95" />
          </div>
          <div>
            <label>ğŸ“… Data</label>
            <input type="text" id="dataProt" disabled />
          </div>
        </div>

        <div class="divider"></div>

        <div class="row">
          <div>
            <label>ğŸ— Frango (g) â€” 31g/100g</label>
            <input type="number" id="prot_frango" placeholder="Ex: 150" oninput="protRecalcular()" />
          </div>
          <div>
            <label>ğŸ¥© Carne (g) â€” 26g/100g</label>
            <input type="number" id="prot_carne" placeholder="Ex: 120" oninput="protRecalcular()" />
          </div>
          <div>
            <label>ğŸ¥š Ovos (un) â€” 6g/un</label>
            <input type="number" id="prot_ovo" placeholder="Ex: 2" oninput="protRecalcular()" />
          </div>
        </div>

        <div class="row">
          <div>
            <label>ğŸ¥› Iogurte (un) â€” 10g/un</label>
            <input type="number" id="prot_iog" placeholder="Ex: 1" oninput="protRecalcular()" />
          </div>
          <div>
            <label>ğŸ§€ Queijo (g) â€” 25g/100g</label>
            <input type="number" id="prot_queijo" placeholder="Ex: 30" oninput="protRecalcular()" />
          </div>
          <div>
            <label>ğŸ¥¤ Whey (scoop) â€” 20g/scoop</label>
            <input type="number" id="prot_whey" placeholder="Ex: 1" oninput="protRecalcular()" />
          </div>
        </div>

        <div class="btns">
          <button class="btn" onclick="protSalvar()">ğŸ’¾ Salvar hoje</button>
          <button class="btn danger" onclick="protZerar()">ğŸ§¹ Zerar hoje</button>
        </div>

        <div class="progress"><div class="bar" id="barProt"></div></div>

        <div class="kpis">
          <div class="kpi">
            <div class="t">ProteÃ­na hoje</div>
            <div class="v" id="protHojeKpi">0 g</div>
            <div class="s" id="protMedia7Kpi">MÃ©dia 7 dias: 0 g</div>
          </div>
          <div class="kpi">
            <div class="t">Meta</div>
            <div class="v" id="protMetaKpi">95 g</div>
            <div class="s" id="protFaltaKpi">Faltam: 95 g</div>
          </div>
        </div>
      </div>

      <!-- INTESTINO -->
      <div class="card" id="sec-intestino">
        <h2>ğŸš½ Intestino + Chia</h2>
        <p class="small">
          Rotina que te ajudou: <b>1 copo Ã¡gua morna + 1 colher de chia</b> (hidratar ~10 min) em jejum âœ…
        </p>

        <label>Hoje vocÃª foi ao banheiro?</label>
        <select id="intestinoSel">
          <option value="nao">NÃ£o</option>
          <option value="sim">Sim</option>
          <option value="pouco">Pouquinho</option>
        </select>

        <label>
          <input type="checkbox" id="chiaCheck" />
          Tomei Ã¡gua morna + chia hoje
        </label>

        <div class="btns">
          <button class="btn" onclick="intSalvar()">ğŸ’¾ Salvar</button>
          <button class="btn danger" onclick="intLimpar()">ğŸ§¹ Limpar hoje</button>
        </div>

        <div class="list small" id="intHistorico"></div>
      </div>

      <!-- PEITO FIRME -->
      <div class="card" id="sec-peito">
        <h2>ğŸ’— Peito firme (apoio)</h2>
        <p class="small">
          Treino nÃ£o â€œlevanta siliconeâ€, mas ajuda MUITO no <b>colo</b> e na <b>postura</b> (fica mais firme visualmente):<br>
          âœ… Supino inclinado (mÃ¡quina) â€¢ âœ… Crucifixo (mÃ¡quina) â€¢ âœ… Desenvolvimento (ombro) â€¢ âœ… Face Pull (postura)
        </p>
        <div class="small">
          <span class="chip">2x/semana</span>
          <span class="chip">3Ã—12</span>
          <span class="chip">controle total</span>
        </div>
      </div>

    </section>

    <!-- =================== TREINO =================== -->
    <section id="view-treino" class="view">
      <div class="card">
        <h2>ğŸ‹ï¸ Treino (Segunda a Sexta)</h2>
        <p class="small">
          ğŸ¯ Foco Ampulheta (B): <b>glÃºteo + postura + core (vÃ¡cuo/prancha)</b> = cintura mais marcada com corpo firme.
        </p>
        <div class="divider"></div>
        <div id="treinoLista"></div>
      </div>
    </section>

    <!-- =================== ÃGUA =================== -->
    <section id="view-agua" class="view">
      <div class="card">
        <h2>ğŸ’§ Controle de Ãgua</h2>
        <div class="row">
          <div>
            <label>ğŸ¯ Meta diÃ¡ria (ml)</label>
            <input type="number" id="metaAgua" value="2500" />
          </div>
          <div>
            <label>â• Adicionar manualmente (ml)</label>
            <input type="number" id="aguaManual" placeholder="Ex: 300" />
          </div>
        </div>

        <div class="btns">
          <button class="btn" onclick="aguaSomarManual()">â• Somar</button>
          <button class="btn ghost" onclick="aguaSomar(470)">+470 ml</button>
          <button class="btn ghost" onclick="aguaSomar(250)">+250 ml</button>
          <button class="btn ghost" onclick="aguaDesfazer()">â†©ï¸ Desfazer</button>
          <button class="btn danger" onclick="aguaZerar()">ğŸ§¹ Zerar hoje</button>
        </div>

        <div class="progress"><div class="bar" id="barAgua"></div></div>

        <div class="kpis">
          <div class="kpi">
            <div class="t">Hoje</div>
            <div class="v" id="aguaHojeKpi">0 ml</div>
            <div class="s" id="aguaMedia7Kpi">MÃ©dia 7 dias: 0 ml</div>
          </div>
          <div class="kpi">
            <div class="t">Status</div>
            <div class="v" id="aguaPct">0%</div>
            <div class="s">bora fechar a meta ğŸ’—</div>
          </div>
        </div>
      </div>
    </section>

    <!-- =================== MEDIDAS =================== -->
    <section id="view-medidas" class="view">
      <div class="card">
        <h2>ğŸ“ Medidas + Ampulheta</h2>
        <p class="small">
          ğŸ“ Medidas: a cada <b>7 dias</b> (manhÃ£, em jejum).<br>
          ğŸ“¸ Fotos: a cada <b>14 dias</b> (mesma luz/posiÃ§Ã£o).
        </p>

        <div class="row">
          <div>
            <label>Peso (kg)</label>
            <input type="number" id="m_peso" placeholder="Ex: 56.9" />
          </div>
          <div>
            <label>Cintura (cm)</label>
            <input type="number" id="m_cintura" placeholder="Ex: 72" />
          </div>
          <div>
            <label>AbdÃ´men (cm)</label>
            <input type="number" id="m_abdomen" placeholder="Ex: 81" />
          </div>
          <div>
            <label>GlÃºteo (cm)</label>
            <input type="number" id="m_gluteo" placeholder="Ex: 96" />
          </div>
        </div>

        <div class="btns">
          <button class="btn" onclick="medSalvar()">ğŸ’¾ Salvar medida</button>
          <button class="btn danger" onclick="medLimparTudo()">ğŸ§¨ Apagar histÃ³rico</button>
        </div>

        <div class="kpis">
          <div class="kpi">
            <div class="t">Ampulheta</div>
            <div class="v" id="kpiAmp">--</div>
            <div class="s" id="kpiNota">Nota: --</div>
          </div>
          <div class="kpi">
            <div class="t">Ãšltima medida</div>
            <div class="v" style="font-size:16px" id="medUltima">--</div>
            <div class="s">salvo no histÃ³rico</div>
          </div>
        </div>
      </div>
    </section>

    <!-- =================== FOTOS =================== -->
    <section id="view-fotos" class="view">
      <div class="card">
        <h2>ğŸ“¸ Fotos (Antes/Depois)</h2>
        <p class="small">
          Cole o link da foto (Google Fotos/Drive) + observaÃ§Ã£o. Assim vocÃª acompanha tudo no app âœ…
        </p>

        <div class="row">
          <div>
            <label>Tipo</label>
            <select id="fotoTipo">
              <option value="antes">Antes</option>
              <option value="depois">Depois</option>
              <option value="check">Check-in</option>
            </select>
          </div>
          <div>
            <label>Data</label>
            <input type="text" id="fotoData" disabled />
          </div>
        </div>

        <label>Link da foto (URL)</label>
        <input type="text" id="fotoUrl" placeholder="Cole o link aqui" />

        <label>ObservaÃ§Ã£o (opcional)</label>
        <textarea id="fotoObs" placeholder="Ex: menos inchaÃ§o / cintura mais marcada"></textarea>

        <div class="btns">
          <button class="btn" onclick="fotoSalvar()">ğŸ’¾ Salvar foto</button>
          <button class="btn danger" onclick="fotoLimparTudo()">ğŸ§¨ Apagar fotos</button>
        </div>

        <div class="list small" id="fotoLista"></div>
      </div>
    </section>

  </div>

  <!-- MENU INFERIOR -->
  <div class="nav">
    <div class="inner">
      <div class="tab active" id="tab-inicio" onclick="goTab('inicio')">
        <span class="ico">ğŸ </span><span class="lbl">InÃ­cio</span>
      </div>
      <div class="tab" id="tab-treino" onclick="goTab('treino')">
        <span class="ico">ğŸ‹ï¸</span><span class="lbl">Treino</span>
      </div>
      <div class="tab" id="tab-agua" onclick="goTab('agua')">
        <span class="ico">ğŸ’§</span><span class="lbl">Ãgua</span>
      </div>
      <div class="tab" id="tab-medidas" onclick="goTab('medidas')">
        <span class="ico">ğŸ“</span><span class="lbl">Medidas</span>
      </div>
      <div class="tab" id="tab-fotos" onclick="goTab('fotos')">
        <span class="ico">ğŸ“¸</span><span class="lbl">Fotos</span>
      </div>
    </div>
  </div>

<script>
/* ========= BASE ========= */
function hojeISO(){ return new Date().toISOString().split("T")[0]; }
function fmtBR(iso){ const [y,m,d]=iso.split("-"); return `${d}/${m}/${y}`; }

const KEY = "app_miria_ampulheta_dark_v1";
let dados = JSON.parse(localStorage.getItem(KEY)) || {
  agua:{}, intestino:{}, medidas:[], fotos:[], proteina:{}
};
function salvar(){ localStorage.setItem(KEY, JSON.stringify(dados)); }

/* ========= NAVEGAÃ‡ÃƒO ========= */
function goTab(tab){
  const views = ["inicio","treino","agua","medidas","fotos"];
  views.forEach(v=>{
    document.getElementById("view-"+v).classList.remove("active");
    document.getElementById("tab-"+v).classList.remove("active");
  });
  document.getElementById("view-"+tab).classList.add("active");
  document.getElementById("tab-"+tab).classList.add("active");
  window.scrollTo({top:0, behavior:"smooth"});
}
function jumpTo(id){
  goTab("inicio");
  setTimeout(()=>{
    document.getElementById(id).scrollIntoView({behavior:"smooth", block:"start"});
  }, 120);
}

/* ========= ÃGUA ========= */
function initAgua(){
  if(!dados.agua[hojeISO()]) dados.agua[hojeISO()] = {total:0, pilha:[]};
}
function aguaSomar(v){
  initAgua();
  dados.agua[hojeISO()].total += v;
  dados.agua[hojeISO()].pilha.push(v);
  salvar(); aguaRender(); miniRender();
}
function aguaSomarManual(){
  const v = Number(document.getElementById("aguaManual").value || 0);
  if(v>0){ aguaSomar(v); document.getElementById("aguaManual").value=""; }
}
function aguaDesfazer(){
  initAgua();
  const ultimo = dados.agua[hojeISO()].pilha.pop();
  if(ultimo) dados.agua[hojeISO()].total -= ultimo;
  salvar(); aguaRender(); miniRender();
}
function aguaZerar(){
  dados.agua[hojeISO()] = {total:0, pilha:[]};
  salvar(); aguaRender(); miniRender();
}
function aguaRender(){
  initAgua();
  const meta = Number(document.getElementById("metaAgua").value || 2500);
  const total = dados.agua[hojeISO()].total;

  document.getElementById("aguaHojeKpi").innerHTML = `${total} ml`;

  let pct = meta>0 ? Math.round((total/meta)*100) : 0;
  if(pct>100) pct=100;
  document.getElementById("barAgua").style.width = pct + "%";
  document.getElementById("aguaPct").innerHTML = pct + "%";

  // mÃ©dia 7 dias
  let soma=0, dias=0;
  for(let i=0;i<7;i++){
    const d = new Date(); d.setDate(d.getDate()-i);
    const k = d.toISOString().split("T")[0];
    if(dados.agua[k]){ soma += dados.agua[k].total; dias++; }
  }
  const media = dias? Math.round(soma/dias) : 0;
  document.getElementById("aguaMedia7Kpi").innerHTML = `MÃ©dia 7 dias: ${media} ml`;
  // mini
  document.getElementById("miniAgua").innerHTML = total + " ml";
  document.getElementById("miniAgua2").innerHTML = "MÃ©dia 7 dias: " + media + " ml";
}

/* ========= PROTEÃNA ========= */
const fatores = {
  frango:{por:100, prot:31},
  carne:{por:100, prot:26},
  ovo:{por:1, prot:6},
  iog:{por:1, prot:10},
  queijo:{por:100, prot:25},
  whey:{por:1, prot:20}
};
function protCalc(qtd,cfg){
  qtd = Number(qtd||0);
  if(qtd<=0) return 0;
  if(cfg.por===1) return qtd*cfg.prot;
  return (qtd/cfg.por)*cfg.prot;
}
function protTotalHojeObj(obj){
  if(!obj) return 0;
  return Math.round(
    protCalc(obj.frango,fatores.frango)+
    protCalc(obj.carne,fatores.carne)+
    protCalc(obj.ovo,fatores.ovo)+
    protCalc(obj.iog,fatores.iog)+
    protCalc(obj.queijo,fatores.queijo)+
    protCalc(obj.whey,fatores.whey)
  );
}
function protRecalcular(){
  const fr = protCalc(document.getElementById("prot_frango").value, fatores.frango);
  const ca = protCalc(document.getElementById("prot_carne").value, fatores.carne);
  const ov = protCalc(document.getElementById("prot_ovo").value, fatores.ovo);
  const io = protCalc(document.getElementById("prot_iog").value, fatores.iog);
  const qu = protCalc(document.getElementById("prot_queijo").value, fatores.queijo);
  const wh = protCalc(document.getElementById("prot_whey").value, fatores.whey);

  const total = Math.round(fr+ca+ov+io+qu+wh);
  const meta = Number(document.getElementById("metaProt").value || 0);
  const falta = Math.max(0, meta-total);

  document.getElementById("protHojeKpi").innerHTML = total + " g";
  document.getElementById("protMetaKpi").innerHTML = meta + " g";
  document.getElementById("protFaltaKpi").innerHTML = "Faltam: " + falta + " g";

  // barra
  let pct = meta>0 ? Math.round((total/meta)*100) : 0;
  if(pct>100) pct=100;
  document.getElementById("barProt").style.width = pct + "%";

  miniRender();
}
function protSalvar(){
  const k = hojeISO();
  dados.proteina[k] = {
    meta: Number(document.getElementById("metaProt").value || 0),
    frango: Number(document.getElementById("prot_frango").value || 0),
    carne: Number(document.getElementById("prot_carne").value || 0),
    ovo: Number(document.getElementById("prot_ovo").value || 0),
    iog: Number(document.getElementById("prot_iog").value || 0),
    queijo: Number(document.getElementById("prot_queijo").value || 0),
    whey: Number(document.getElementById("prot_whey").value || 0)
  };
  salvar(); protRender(); miniRender();
}
function protZerar(){
  delete dados.proteina[hojeISO()];
  document.getElementById("prot_frango").value="";
  document.getElementById("prot_carne").value="";
  document.getElementById("prot_ovo").value="";
  document.getElementById("prot_iog").value="";
  document.getElementById("prot_queijo").value="";
  document.getElementById("prot_whey").value="";
  salvar(); protRender(); miniRender();
}
function protRender(){
  const k = hojeISO();
  document.getElementById("dataProt").value = fmtBR(k);

  const d = dados.proteina[k];
  if(d){
    document.getElementById("metaProt").value = d.meta || 95;
    document.getElementById("prot_frango").value = d.frango || "";
    document.getElementById("prot_carne").value = d.carne || "";
    document.getElementById("prot_ovo").value = d.ovo || "";
    document.getElementById("prot_iog").value = d.iog || "";
    document.getElementById("prot_queijo").value = d.queijo || "";
    document.getElementById("prot_whey").value = d.whey || "";
  }

  protRecalcular();

  // mÃ©dia 7 dias
  let soma=0, dias=0;
  for(let i=0;i<7;i++){
    const dt = new Date(); dt.setDate(dt.getDate()-i);
    const key = dt.toISOString().split("T")[0];
    if(dados.proteina[key]){
      soma += protTotalHojeObj(dados.proteina[key]);
      dias++;
    }
  }
  const media = dias? Math.round(soma/dias) : 0;
  document.getElementById("protMedia7Kpi").innerHTML = "MÃ©dia 7 dias: " + media + " g";
}

/* ========= INTESTINO ========= */
function intSalvar(){
  dados.intestino[hojeISO()] = {
    foi: document.getElementById("intestinoSel").value,
    chia: document.getElementById("chiaCheck").checked
  };
  salvar(); intRender(); miniRender();
}
function intLimpar(){
  delete dados.intestino[hojeISO()];
  salvar(); intRender(); miniRender();
}
function intRender(){
  const d = dados.intestino[hojeISO()];
  if(d){
    document.getElementById("intestinoSel").value = d.foi;
    document.getElementById("chiaCheck").checked = !!d.chia;
  }else{
    document.getElementById("intestinoSel").value = "nao";
    document.getElementById("chiaCheck").checked = false;
  }

  const entries = Object.entries(dados.intestino).sort((a,b)=>a[0].localeCompare(b[0]));
  const ult = entries.slice(-10).reverse().map(([data,val])=>{
    const foiTxt = val.foi==="sim" ? "âœ… Sim" : (val.foi==="pouco" ? "ğŸŸ¡ Pouquinho" : "âŒ NÃ£o");
    const chiaTxt = val.chia ? " + ğŸŒ¿ chia" : "";
    return `<div>ğŸ“… <b>${fmtBR(data)}</b> â€” ${foiTxt}${chiaTxt}</div>`;
  }).join("");
  document.getElementById("intHistorico").innerHTML = ult || "Sem registros ainda.";
}

/* ========= MEDIDAS ========= */
function ampNota(r){
  if(!isFinite(r) || r<=0) return {nota:"--", txt:"--"};
  if(r>=1.35) return {nota:"A+", txt:"ğŸ”¥ Muito marcada"};
  if(r>=1.30) return {nota:"A", txt:"ğŸ‘ Ampulheta forte"};
  if(r>=1.25) return {nota:"B", txt:"âœ¨ Boa (em construÃ§Ã£o)"};
  return {nota:"C", txt:"ğŸ“ˆ Vamos marcar mais"};
}
function medSalvar(){
  const item = {
    data: hojeISO(),
    peso: Number(document.getElementById("m_peso").value || 0),
    cintura: Number(document.getElementById("m_cintura").value || 0),
    abdomen: Number(document.getElementById("m_abdomen").value || 0),
    gluteo: Number(document.getElementById("m_gluteo").value || 0)
  };
  dados.medidas.push(item);
  salvar(); medRender(); miniRender();
}
function medLimparTudo(){
  if(confirm("Quer apagar TODO o histÃ³rico de medidas?")){
    dados.medidas = [];
    salvar(); medRender(); miniRender();
  }
}
function medRender(){
  const last = dados.medidas.length ? dados.medidas[dados.medidas.length-1] : null;
  if(!last){
    document.getElementById("kpiAmp").innerHTML="--";
    document.getElementById("kpiNota").innerHTML="Nota: --";
    document.getElementById("medUltima").innerHTML="--";
    return;
  }
  const r = last.cintura>0 ? (last.gluteo/last.cintura) : 0;
  const rTxt = r ? r.toFixed(2) : "--";
  const an = ampNota(r);

  document.getElementById("kpiAmp").innerHTML = rTxt;
  document.getElementById("kpiNota").innerHTML = `Nota: <b>${an.nota}</b> â€” ${an.txt}`;
  document.getElementById("medUltima").innerHTML =
    `<b>${fmtBR(last.data)}</b><br>
     Peso ${last.peso}kg â€¢ Cintura ${last.cintura} â€¢ AbdÃ´men ${last.abdomen} â€¢ GlÃºteo ${last.gluteo}`;

  // mini
  document.getElementById("miniAmp").innerHTML = rTxt;
  document.getElementById("miniAmp2").innerHTML = `${an.nota} â€¢ ${an.txt}`;
}

/* ========= FOTOS ========= */
function fotoSalvar(){
  const item = {
    data: hojeISO(),
    tipo: document.getElementById("fotoTipo").value,
    url: (document.getElementById("fotoUrl").value || "").trim(),
    obs: (document.getElementById("fotoObs").value || "").trim()
  };
  if(!item.url){ alert("Cole um link da foto (URL)."); return; }
  dados.fotos.push(item);
  document.getElementById("fotoUrl").value="";
  document.getElementById("fotoObs").value="";
  salvar(); fotoRender();
}
function fotoLimparTudo(){
  if(confirm("Quer apagar TODAS as fotos salvas?")){
    dados.fotos = [];
    salvar(); fotoRender();
  }
}
function fotoRender(){
  document.getElementById("fotoData").value = fmtBR(hojeISO());
  const items = dados.fotos.slice().reverse().slice(0,30).map(f=>{
    const emoji = f.tipo==="antes" ? "ğŸŸ£" : (f.tipo==="depois" ? "ğŸŸ¢" : "ğŸ“¸");
    const obs = f.obs ? ` â€” <i>${f.obs}</i>` : "";
    return `<div>${emoji} <b>${fmtBR(f.data)}</b> â€¢ ${f.tipo.toUpperCase()} â€¢ <a href="${f.url}" target="_blank">abrir</a>${obs}</div>`;
  }).join("");
  document.getElementById("fotoLista").innerHTML = items || "Sem fotos salvas ainda.";
}

/* ========= TREINO (SEGâ€“SEX) ========= */
const treinos = {
  "Segunda â€“ GlÃºteo/Posterior ğŸ‘": [
    {n:"1ï¸âƒ£ Cadeira Flexora", s:"3Ã—12", w:"20â€“25kg", t:"Controle total. Sem tirar o quadril do banco.", v:"https://www.youtube.com/results?search_query=cadeira+flexora+como+fazer+correto"},
    {n:"2ï¸âƒ£ Stiff com Halter", s:"3Ã—12", w:"6â€“8kg cada lado", t:"Coluna neutra. Desce devagar. Sente alongar posterior.", v:"https://www.youtube.com/results?search_query=stiff+com+halter+como+fazer"},
    {n:"3ï¸âƒ£ ElevaÃ§Ã£o pÃ©lvica (Hip Thrust)", s:"4Ã—10", w:"20kg (meta evoluir)", t:"Pausa 1s no topo. NÃ£o arquear lombar.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+p%C3%A9lvica+como+fazer"},
    {n:"4ï¸âƒ£ Abdutora mÃ¡quina", s:"3Ã—15", w:"30â€“35kg", t:"Inclina levemente pra frente e segura 1s aberta.", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
    {n:"ğŸš¶â€â™€ï¸ Cardio (opcional)", s:"12 min", w:"esteira inclinada", t:"Leve/moderado pra ajudar barriga sem perder glÃºteo.", v:"https://www.youtube.com/results?search_query=esteira+inclinada+como+fazer"}
  ],
  "TerÃ§a â€“ Peito + Ombro + Core âœ¨": [
    {n:"1ï¸âƒ£ Supino inclinado (mÃ¡quina)", s:"3Ã—12", w:"15â€“20kg", t:"Peito aberto. Ombros pra baixo.", v:"https://www.youtube.com/results?search_query=supino+inclinado+m%C3%A1quina+como+fazer"},
    {n:"2ï¸âƒ£ Crucifixo (mÃ¡quina)", s:"3Ã—12", w:"15kg", t:"Controlado. NÃ£o esticar demais.", v:"https://www.youtube.com/results?search_query=crucifixo+m%C3%A1quina+como+fazer"},
    {n:"3ï¸âƒ£ ElevaÃ§Ã£o lateral (halter)", s:"3Ã—12", w:"4kg", t:"Sobe atÃ© linha do ombro. Sem balanÃ§ar.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+lateral+halter+como+fazer"},
    {n:"4ï¸âƒ£ Desenvolvimento ombro (halter)", s:"3Ã—10", w:"6kg", t:"Controle. Sem forÃ§ar lombar.", v:"https://www.youtube.com/results?search_query=desenvolvimento+ombro+halter+como+fazer"},
    {n:"â³ VÃ¡cuo abdominal", s:"3Ã—20s", w:"cintura", t:"Solta o ar e puxa o umbigo pra dentro.", v:"https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer"}
  ],
  "Quarta â€“ QuadrÃ­ceps + GlÃºteo ğŸ‘": [
    {n:"1ï¸âƒ£ Leg Press", s:"4Ã—12", w:"80kg (meta 100â€“110kg)", t:"PÃ© um pouco mais alto. NÃ£o travar joelho.", v:"https://www.youtube.com/results?search_query=leg+press+como+fazer+correto"},
    {n:"2ï¸âƒ£ Agachamento no Smith", s:"3Ã—10", w:"10kg cada lado", t:"PÃ©s levemente Ã  frente. Desce controlado.", v:"https://www.youtube.com/results?search_query=agachamento+no+smith+como+fazer"},
    {n:"3ï¸âƒ£ Cadeira Extensora", s:"3Ã—12", w:"25kg", t:"Sobe forte e desce controlando.", v:"https://www.youtube.com/results?search_query=cadeira+extensora+como+fazer"},
    {n:"4ï¸âƒ£ Abdutora", s:"3Ã—15", w:"30â€“35kg", t:"Foco glÃºteo lateral (ajuda ampulheta).", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"}
  ],
  "Quinta â€“ Costas + Postura ğŸ§â€â™€ï¸": [
    {n:"1ï¸âƒ£ Puxada frente", s:"3Ã—12", w:"25kg", t:"Puxa com cotovelos. Ombros pra baixo.", v:"https://www.youtube.com/results?search_query=puxada+frente+na+polia+como+fazer"},
    {n:"2ï¸âƒ£ Remada baixa", s:"3Ã—12", w:"25kg", t:"Segura 1s atrÃ¡s. Postura firme.", v:"https://www.youtube.com/results?search_query=remada+baixa+na+polia+como+fazer"},
    {n:"3ï¸âƒ£ Face Pull", s:"3Ã—15", w:"leve/mÃ©dio", t:"Postura + parte de cima mais firme.", v:"https://www.youtube.com/results?search_query=face+pull+como+fazer"},
    {n:"4ï¸âƒ£ Prancha", s:"3Ã—40s", w:"core", t:"Barriga pra dentro. Sem cair lombar.", v:"https://www.youtube.com/results?search_query=prancha+abdominal+como+fazer"}
  ],
  "Sexta â€“ GlÃºteo foco ğŸ‘ğŸ”¥": [
    {n:"1ï¸âƒ£ ElevaÃ§Ã£o pÃ©lvica (pesado)", s:"4Ã—8", w:"30kg (meta 45kg)", t:"Forma perfeita. Pausa no topo.", v:"https://www.youtube.com/results?search_query=hip+thrust+como+fazer"},
    {n:"2ï¸âƒ£ Stiff", s:"3Ã—12", w:"8kg cada lado", t:"Controle, coluna neutra.", v:"https://www.youtube.com/results?search_query=stiff+com+halter+como+fazer"},
    {n:"3ï¸âƒ£ Afundo andando", s:"3Ã—10 cada perna", w:"4â€“6kg", t:"Tronco levemente Ã  frente, calcanhar empurra.", v:"https://www.youtube.com/results?search_query=afundo+andando+como+fazer"},
    {n:"4ï¸âƒ£ Abdutora", s:"4Ã—15", w:"35â€“40kg", t:"Segura 1s aberta. GlÃºteo lateral.", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
    {n:"â³ VÃ¡cuo abdominal", s:"3Ã—20s", w:"cintura", t:"ConsistÃªncia 3x/semana.", v:"https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer"}
  ]
};
function treinoRender(){
  let html="";
  Object.entries(treinos).forEach(([dia,lista])=>{
    html += `<div style="margin:10px 0 6px"><b>${dia}</b></div>`;
    lista.forEach(ex=>{
      html += `
        <div class="card" style="margin:10px 0;padding:12px;border-radius:18px;box-shadow:none;background:rgba(255,255,255,.03)">
          <div><b>${ex.n}</b> <span class="chip">${ex.s}</span> <span class="chip">${ex.w}</span></div>
          <div class="small" style="margin-top:6px">${ex.t}</div>
          <div class="small" style="margin-top:8px">â–¶ï¸ <a href="${ex.v}" target="_blank">Ver vÃ­deo (PT)</a></div>
        </div>`;
    });
  });
  document.getElementById("treinoLista").innerHTML = html;
}

/* ========= MINI RESUMO ========= */
function miniRender(){
  // proteÃ­na
  const k = hojeISO();
  const d = dados.proteina[k];
  const meta = Number(document.getElementById("metaProt")?.value || (d?.meta||95));
  const total = d ? protTotalHojeObj(d) : (()=> {
    const fr = protCalc(document.getElementById("prot_frango")?.value, fatores.frango);
    const ca = protCalc(document.getElementById("prot_carne")?.value, fatores.carne);
    const ov = protCalc(document.getElementById("prot_ovo")?.value, fatores.ovo);
    const io = protCalc(document.getElementById("prot_iog")?.value, fatores.iog);
    const qu = protCalc(document.getElementById("prot_queijo")?.value, fatores.queijo);
    const wh = protCalc(document.getElementById("prot_whey")?.value, fatores.whey);
    return Math.round(fr+ca+ov+io+qu+wh);
  })();
  document.getElementById("miniProt").innerHTML = total + " g";
  document.getElementById("miniProt2").innerHTML = "Meta: " + meta + " g";

  // intestino
  const it = dados.intestino[k];
  const txt = it ? (it.foi==="sim" ? "âœ… Sim" : (it.foi==="pouco" ? "ğŸŸ¡ Pouquinho" : "âŒ NÃ£o")) : "--";
  document.getElementById("miniInt").innerHTML = txt;
  document.getElementById("miniInt2").innerHTML = it?.chia ? "ğŸŒ¿ com chia" : "sem registro";
}

/* ========= INIT ========= */
document.getElementById("dataProt").value = fmtBR(hojeISO());
document.getElementById("fotoData").value = fmtBR(hojeISO());

initAgua(); aguaRender();
protRender();
intRender();
medRender();
fotoRender();
treinoRender();
miniRender();

// listeners de metas
document.getElementById("metaAgua").addEventListener("input", ()=>{ aguaRender(); });
document.getElementById("metaProt").addEventListener("input", ()=>{ protRecalcular(); });

</script>
</body>
</html>
