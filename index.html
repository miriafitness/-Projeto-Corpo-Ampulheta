<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>MiriÃ£ Sculptâ„¢</title>

<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0b0b12" />

<style>
  :root{
    --bg:#0b0b12;
    --bg2:#101022;
    --card: rgba(255,255,255,0.06);
    --card2: rgba(255,255,255,0.08);
    --text:#f3f3f6;
    --muted: rgba(243,243,246,.70);
    --muted2: rgba(243,243,246,.55);
    --stroke: rgba(255,255,255,.10);
    --hot:#ff3d9a;
    --hot2:#ff6bb8;
    --gold:#d8b35a;
    --ok:#3dffb2;
    --warn:#ffd166;
    --bad:#ff5a5f;
    --shadow: 0 18px 55px rgba(0,0,0,.55);
    --radius: 22px;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color: var(--text);
    background:
      radial-gradient(900px 500px at 20% 0%, rgba(255,61,154,.18), transparent 55%),
      radial-gradient(700px 420px at 90% 15%, rgba(216,179,90,.14), transparent 60%),
      radial-gradient(900px 600px at 50% 120%, rgba(255,61,154,.12), transparent 60%),
      var(--bg);
    padding-bottom: 92px;
  }

  .wrap{max-width: 980px; margin: 0 auto; padding: 18px 14px 30px;}

  .top{
    display:flex; align-items:center; justify-content:space-between; gap:12px;
    padding: 12px 10px 6px;
  }
  .brand{display:flex; align-items:center; gap:12px;}
  .logo{
    width: 54px; height:54px; border-radius: 18px;
    background: linear-gradient(135deg, rgba(255,61,154,.95), rgba(216,179,90,.60));
    box-shadow: 0 16px 40px rgba(255,61,154,.18);
    display:grid; place-items:center;
    border:1px solid rgba(255,255,255,.15);
    flex:0 0 auto;
  }
  .logo span{font-size: 26px; filter: drop-shadow(0 6px 16px rgba(0,0,0,.45));}
  .brand h1{
    font-size: 20px; line-height:1.1; margin:0;
    letter-spacing:.2px;
  }
  .brand p{
    margin:6px 0 0; font-size:12px; color: var(--muted);
  }
  .pill{
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.10);
    border-radius: 999px;
    padding: 10px 12px;
    color: var(--muted);
    font-size: 12px;
    box-shadow: 0 10px 30px rgba(0,0,0,.35);
  }

  .grid2{
    display:grid;
    grid-template-columns: 1fr;
    gap: 14px;
    margin-top: 10px;
  }
  @media(min-width: 880px){
    .grid2{grid-template-columns: 1.25fr .95fr;}
  }

  .card{
    background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.05));
    border:1px solid rgba(255,255,255,.10);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow:hidden;
  }
  .card .hd{
    display:flex; align-items:flex-start; justify-content:space-between; gap:12px;
    padding: 16px 16px 0;
  }
  .card .hd h2{
    margin:0; font-size: 18px; letter-spacing:.2px;
  }
  .card .hd p{
    margin:6px 0 0; color: var(--muted); font-size: 12px;
  }
  .card .bd{padding: 14px 16px 16px;}

  .btn{
    cursor:pointer;
    border:none;
    color:#fff;
    background: linear-gradient(135deg, var(--hot), #ff2f7b);
    padding: 10px 12px;
    border-radius: 14px;
    font-weight: 700;
    letter-spacing:.2px;
    box-shadow: 0 14px 35px rgba(255,61,154,.20);
  }
  .btn:active{transform: translateY(1px)}
  .btn2{
    cursor:pointer;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.06);
    color: var(--text);
    padding: 10px 12px;
    border-radius: 14px;
    font-weight: 700;
  }
  .btn3{
    cursor:pointer;
    border:1px dashed rgba(255,255,255,.18);
    background: rgba(255,255,255,.04);
    color: var(--text);
    padding: 10px 12px;
    border-radius: 14px;
    font-weight: 700;
  }
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center;}

  .tabs{
    position: fixed;
    left:0; right:0; bottom: 0;
    padding: 10px 10px 14px;
    background: linear-gradient(180deg, rgba(11,11,18,0), rgba(11,11,18,.92) 35%, rgba(11,11,18,.98));
    backdrop-filter: blur(10px);
    z-index: 999;
  }
  .tabs .bar{
    max-width: 980px;
    margin:0 auto;
    display:grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
  }
  .tab{
    border-radius: 18px;
    padding: 10px 8px;
    text-align:center;
    background: rgba(255,255,255,.05);
    border:1px solid rgba(255,255,255,.10);
    color: var(--muted);
    font-weight: 800;
    letter-spacing:.15px;
    cursor:pointer;
    user-select:none;
  }
  .tab small{display:block; opacity:.8; font-weight:700; margin-top:2px;}
  .tab.active{
    color: #fff;
    background: linear-gradient(135deg, rgba(255,61,154,.35), rgba(216,179,90,.12));
    border:1px solid rgba(255,61,154,.30);
    box-shadow: 0 18px 45px rgba(255,61,154,.18);
  }

  .section{display:none;}
  .section.active{display:block;}

  .chips{
    display:flex; gap:10px; flex-wrap:wrap;
    padding: 10px 0 2px;
  }
  .chip{
    padding: 10px 14px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    color: var(--muted);
    font-weight: 800;
    cursor:pointer;
    user-select:none;
  }
  .chip.active{
    background: rgba(255,61,154,.22);
    border:1px solid rgba(255,61,154,.30);
    color:#fff;
  }

  .note{
    padding: 10px 12px;
    border-radius: 16px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    color: var(--muted);
    font-size: 13px;
    margin-top: 10px;
  }
  .list{
    margin-top: 12px;
    border-radius: 18px;
    overflow:hidden;
    border:1px solid rgba(255,255,255,.10);
  }
  .item{
    padding: 12px 12px;
    background: rgba(255,255,255,.04);
    border-bottom: 1px solid rgba(255,255,255,.08);
  }
  .item:last-child{border-bottom:none;}
  .item h3{margin:0; font-size: 15px;}
  .item .meta{margin:6px 0 0; color: var(--muted); font-size: 12px;}
  .item .hint{margin:6px 0 0; color: var(--muted2); font-size: 12px;}
  .item a{color: var(--hot2); text-decoration:none; font-weight: 800;}
  .item a:hover{text-decoration:underline;}

  .mini{
    margin-top: 10px;
    display:grid;
    grid-template-columns: 1fr;
    gap: 10px;
  }
  @media(min-width: 740px){
    .mini{grid-template-columns: 1fr 1fr;}
  }
  .box{
    border-radius: 18px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    padding: 12px;
  }
  label{display:block; color: var(--muted); font-weight:800; font-size: 12px; margin:10px 0 6px;}
  input, select, textarea{
    width:100%;
    padding: 12px 12px;
    border-radius: 14px;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.04);
    color: var(--text);
    outline:none;
  }
  textarea{min-height: 90px; resize: vertical;}

  .progress{
    width:100%;
    height: 14px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.06);
    overflow:hidden;
    margin-top: 10px;
  }
  .bar{
    height:100%;
    width:0%;
    border-radius: 999px;
    background: linear-gradient(90deg, var(--hot), var(--gold));
    transition: width .25s ease;
  }

  .kpi{display:flex; gap:10px; flex-wrap:wrap; margin-top: 10px;}
  .kpi .tag{
    padding: 8px 10px;
    border-radius: 999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    color: var(--muted);
    font-weight: 900;
    font-size: 12px;
  }
  .tag b{color:#fff;}
  .tag.ok{border-color: rgba(61,255,178,.25); background: rgba(61,255,178,.08);}
  .tag.warn{border-color: rgba(255,209,102,.25); background: rgba(255,209,102,.08);}
  .tag.bad{border-color: rgba(255,90,95,.25); background: rgba(255,90,95,.08);}

  .sep{height:1px; background: rgba(255,255,255,.10); margin: 14px 0;}
  .muted{color: var(--muted); font-size: 12px;}
  .small{font-size: 12px; color: var(--muted);}

  /* modal trocar exercÃ­cio */
  .modal{
    position:fixed; inset:0;
    background: rgba(0,0,0,.55);
    display:none;
    align-items:flex-end;
    justify-content:center;
    z-index: 2000;
    padding: 14px;
  }
  .modal.open{display:flex;}
  .sheet{
    width:min(680px, 100%);
    background: linear-gradient(180deg, rgba(25,25,40,.98), rgba(16,16,30,.98));
    border:1px solid rgba(255,255,255,.12);
    border-radius: 26px;
    box-shadow: 0 30px 90px rgba(0,0,0,.65);
    overflow:hidden;
  }
  .sheet .shd{
    padding: 14px 14px 10px;
    display:flex; justify-content:space-between; align-items:flex-start; gap: 10px;
  }
  .sheet .shd h3{margin:0; font-size: 16px;}
  .sheet .shd p{margin:6px 0 0; color: var(--muted); font-size: 12px;}
  .sheet .sbd{padding: 12px 14px 14px;}
  .opt{
    padding: 12px 12px;
    border-radius: 16px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.05);
    cursor:pointer;
    margin-bottom: 10px;
  }
  .opt b{display:block;}
  .opt span{display:block; color: var(--muted); font-size: 12px; margin-top: 4px;}
  .opt:hover{border-color: rgba(255,61,154,.28);}
</style>
</head>

<body>
<div class="wrap">

  <div class="top">
    <div class="brand">
      <div class="logo"><span>ğŸ‘</span></div>
      <div>
        <h1>MiriÃ£ Sculptâ„¢</h1>
        <p>Esculpindo curvas com estratÃ©gia. Preto + Dourado + Rosa suave ğŸ’</p>
      </div>
    </div>
    <div class="pill">salva no seu celular â€¢ funciona offline</div>
  </div>

  <!-- INÃCIO -->
  <div id="sec-inicio" class="section active">
    <div class="grid2">

      <div class="card">
        <div class="hd">
          <div>
            <h2>âš¡ Atalhos</h2>
            <p>um toque e pronto</p>
          </div>
        </div>
        <div class="bd">
          <div class="row">
            <button class="btn" onclick="go('agua')">ğŸ’§ Ãgua</button>
            <button class="btn" onclick="go('proteina')">ğŸ¥© ProteÃ­na</button>
            <button class="btn" onclick="go('intestino')">ğŸš½ Intestino</button>
            <button class="btn" onclick="go('medidas')">ğŸ“ Medidas</button>
            <button class="btn2" onclick="go('treino')">ğŸ‹ï¸ Treino</button>
            <button class="btn2" onclick="go('fotos')">ğŸ“¸ Fotos</button>
          </div>

          <div class="sep"></div>

          <div class="note">
            ğŸ¯ <b>Foco Ampulheta (B)</b>: costas + postura + core (vÃ¡cuo) + glÃºteo (hip thrust) = cintura mais marcada sem â€œafinar pelo ossoâ€.
          </div>

          <div class="kpi" id="inicioKPIs"></div>
        </div>
      </div>

      <div class="card">
        <div class="hd">
          <div>
            <h2>ğŸ“Œ Regras rÃ¡pidas</h2>
            <p>pra nÃ£o travar e evoluir</p>
          </div>
        </div>
        <div class="bd">
          <div class="note">ğŸ‘ Regra: se completou reps com folga â†’ <b>sobe peso</b> na prÃ³xima.</div>
          <div class="note">ğŸ§  TÃ©cnica perfeita vale mais que carga.</div>
          <div class="note">ğŸ“ Medidas + fotos: <b>1x por semana</b> (sempre no mesmo dia/horÃ¡rio). Ex: domingo de manhÃ£.</div>
        </div>
      </div>

    </div>
  </div>

  <!-- TREINO -->
  <div id="sec-treino" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸ“… Treino SEGâ€“SEX (Ampulheta)</h2>
          <p>clique no dia + registre suas cargas</p>
        </div>
        <button class="btn2" onclick="go('cargas')">ğŸ“ Registrar cargas</button>
      </div>
      <div class="bd">

        <div class="chips" id="chipsDias"></div>

        <div class="note">â±ï¸ Descanso: principais <b>1mâ€“1m30</b> â€¢ acessÃ³rios <b>45sâ€“1m</b></div>

        <div class="list" id="listaTreino"></div>

        <div class="sep"></div>

        <div class="mini">
          <div class="box">
            <b>ğŸ“ˆ Progresso (2 regras)</b>
            <div class="small" style="margin-top:8px">âœ… Se fez todas as reps com boa forma â†’ sobe 1â€“2kg na prÃ³xima.</div>
            <div class="small" style="margin-top:6px">âœ… Se travou antes do mÃ­nimo â†’ mantÃ©m e melhora a execuÃ§Ã£o.</div>
          </div>

          <div class="box">
            <b>ğŸ§˜â€â™€ï¸ Cintura (vÃ¡cuo)</b>
            <div class="small" style="margin-top:8px">FaÃ§a <b>3x/semana</b> (20â€“30s). ConsistÃªncia = cintura mais marcada.</div>
            <a class="small" href="https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer" target="_blank">â–¶ ver vÃ­deo (PT)</a>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- CARGAS -->
  <div id="sec-cargas" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸ“ Registrar cargas</h2>
          <p>salva peso/reps por exercÃ­cio (histÃ³rico)</p>
        </div>
        <button class="btn2" onclick="go('treino')">â† voltar</button>
      </div>
      <div class="bd">
        <label>Dia</label>
        <select id="cDia"></select>

        <label>ExercÃ­cio</label>
        <select id="cEx"></select>

        <div class="mini">
          <div class="box">
            <label>Carga (kg)</label>
            <input id="cKg" type="number" placeholder="Ex: 18">
          </div>
          <div class="box">
            <label>Reps</label>
            <input id="cRep" type="text" placeholder="Ex: 12, 10, 10">
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn" onclick="salvarCarga()">ğŸ’¾ Salvar</button>
          <button class="btn3" onclick="limparCargasDia()">ğŸ§¹ Limpar dia</button>
        </div>

        <div class="sep"></div>
        <div class="box">
          <b>ğŸ“š HistÃ³rico</b>
          <div class="small" id="histCargas" style="margin-top:10px"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ÃGUA -->
  <div id="sec-agua" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸ’§ Ãgua</h2>
          <p>digite ml e o app soma + mÃ©dia 7 dias</p>
        </div>
        <button class="btn3" onclick="zerarAgua()">ğŸ§¹ Zerar hoje</button>
      </div>
      <div class="bd">
        <label>ğŸ¯ Meta diÃ¡ria (ml)</label>
        <input type="number" id="aguaMeta" value="2500">

        <label>â• Adicionar manualmente (ml)</label>
        <input type="number" id="aguaManual" placeholder="Ex: 470">

        <div class="row" style="margin-top:10px">
          <button class="btn" onclick="addAguaManual()">â• Somar</button>
          <button class="btn2" onclick="addAgua(470)">+470 ml</button>
          <button class="btn2" onclick="addAgua(250)">+250 ml</button>
          <button class="btn3" onclick="desfazerAgua()">â†©ï¸ Desfazer</button>
        </div>

        <div class="progress"><div class="bar" id="aguaBar"></div></div>

        <div class="kpi">
          <div class="tag"><b id="aguaHoje">0</b> ml hoje</div>
          <div class="tag"><b id="aguaFalta">0</b> ml faltam</div>
          <div class="tag"><b id="aguaMedia7">0</b> ml mÃ©dia (7 dias)</div>
        </div>
      </div>
    </div>
  </div>

  <!-- PROTEÃNA -->
  <div id="sec-proteina" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸ¥© ProteÃ­na (auto)</h2>
          <p>vocÃª escolhe o alimento + quantidade â†’ o app calcula e soma</p>
        </div>
        <button class="btn3" onclick="zerarProteina()">ğŸ§¹ Zerar hoje</button>
      </div>
      <div class="bd">
        <label>ğŸ¯ Meta de proteÃ­na (g/dia)</label>
        <input type="number" id="protMeta" value="95">

        <div class="mini">
          <div class="box">
            <label>ğŸ— Frango (gramas)</label>
            <input type="number" id="pFrango" placeholder="Ex: 150">
            <div class="small">31g a cada 100g</div>
          </div>
          <div class="box">
            <label>ğŸ¥© Carne (gramas)</label>
            <input type="number" id="pCarne" placeholder="Ex: 120">
            <div class="small">26g a cada 100g</div>
          </div>
          <div class="box">
            <label>ğŸ¥š Ovo (unidades)</label>
            <input type="number" id="pOvo" placeholder="Ex: 2">
            <div class="small">6g por unidade</div>
          </div>
          <div class="box">
            <label>ğŸ¥› Iogurte (unidades)</label>
            <input type="number" id="pIog" placeholder="Ex: 1">
            <div class="small">10g por unidade</div>
          </div>
          <div class="box">
            <label>ğŸ§€ Queijo (gramas)</label>
            <input type="number" id="pQueijo" placeholder="Ex: 30">
            <div class="small">25g a cada 100g</div>
          </div>
          <div class="box">
            <label>ğŸ¥¤ Whey (scoop)</label>
            <input type="number" id="pWhey" placeholder="Ex: 1">
            <div class="small">20g por scoop</div>
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn" onclick="calcProteina()">âœ… Calcular e salvar</button>
        </div>

        <div class="progress"><div class="bar" id="protBar"></div></div>

        <div class="kpi" id="protKPIs"></div>

        <div class="sep"></div>
        <div class="box">
          <b>ğŸ“Š MÃ©dia (7 dias)</b>
          <div class="small" id="protMedia7" style="margin-top:10px"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- INTESTINO -->
  <div id="sec-intestino" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸš½ Intestino</h2>
          <p>acompanhar se a Ã¡gua morna + chia estÃ¡ ajudando</p>
        </div>
      </div>
      <div class="bd">
        <label>Hoje fui ao banheiro?</label>
        <select id="intSel">
          <option value="nao">NÃ£o</option>
          <option value="sim">Sim</option>
          <option value="pouco">Pouquinho</option>
        </select>

        <label style="display:flex; gap:10px; align-items:center; margin-top:12px">
          <input type="checkbox" id="chiaSel" style="width:auto; transform:scale(1.2)">
          Tomei Ã¡gua morna + chia (10 min hidratando) ğŸŒ¿
        </label>

        <div class="row" style="margin-top:12px">
          <button class="btn" onclick="salvarIntestino()">ğŸ’¾ Salvar</button>
          <button class="btn3" onclick="limparIntestino()">ğŸ§¹ Limpar hoje</button>
        </div>

        <div class="sep"></div>
        <div class="box">
          <b>ğŸ“† Ãšltimos registros</b>
          <div class="small" id="histInt" style="margin-top:10px"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- MEDIDAS -->
  <div id="sec-medidas" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸ“ Medidas + ProporÃ§Ã£o</h2>
          <p>cintura / abdÃ´men / glÃºteo + nota ampulheta</p>
        </div>
      </div>
      <div class="bd">
        <div class="mini">
          <div class="box">
            <label>Peso (kg)</label>
            <input type="number" id="mPeso" placeholder="Ex: 56.9">
          </div>
          <div class="box">
            <label>Cintura (cm)</label>
            <input type="number" id="mCint" placeholder="Ex: 72">
          </div>
          <div class="box">
            <label>AbdÃ´men (cm)</label>
            <input type="number" id="mAbd" placeholder="Ex: 81">
          </div>
          <div class="box">
            <label>GlÃºteo (cm)</label>
            <input type="number" id="mGlu" placeholder="Ex: 96">
          </div>
        </div>

        <div class="row" style="margin-top:12px">
          <button class="btn" onclick="salvarMedidas()">ğŸ’¾ Salvar</button>
          <button class="btn3" onclick="limparMedidasHoje()">ğŸ§¹ Limpar hoje</button>
        </div>

        <div class="sep"></div>

        <div class="box">
          <b>ğŸ‘ Ampulheta (GlÃºteo Ã· Cintura)</b>
          <div class="small" id="ampInfo" style="margin-top:10px"></div>
        </div>

        <div class="sep"></div>
        <div class="box">
          <b>ğŸ“ˆ EvoluÃ§Ã£o do glÃºteo (Ãºltimos registros)</b>
          <div class="small" id="gluChartText" style="margin-top:10px"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- FOTOS -->
  <div id="sec-fotos" class="section">
    <div class="card">
      <div class="hd">
        <div>
          <h2>ğŸ“¸ Fotos (antes/depois)</h2>
          <p>1x por semana (mesma luz/posiÃ§Ã£o)</p>
        </div>
      </div>
      <div class="bd">
        <label>Colar link da foto (Drive, iCloud, etc.)</label>
        <input id="fotoLink" placeholder="Cole aqui o link da sua foto">

        <label>ObservaÃ§Ã£o (opcional)</label>
        <input id="fotoObs" placeholder="Ex: semana 3 â€¢ pÃ³s treino">

        <div class="row" style="margin-top:12px">
          <button class="btn" onclick="salvarFoto()">ğŸ’¾ Salvar</button>
          <button class="btn3" onclick="limparFotos()">ğŸ§¹ Limpar tudo</button>
        </div>

        <div class="sep"></div>
        <div class="box">
          <b>ğŸ“š HistÃ³rico</b>
          <div class="small" id="histFotos" style="margin-top:10px"></div>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- bottom tabs -->
<div class="tabs">
  <div class="bar">
    <div class="tab active" id="t-inicio" onclick="go('inicio')">ğŸ <small>InÃ­cio</small></div>
    <div class="tab" id="t-treino" onclick="go('treino')">ğŸ‹ï¸<small>Treino</small></div>
    <div class="tab" id="t-agua" onclick="go('agua')">ğŸ’§<small>Ãgua</small></div>
    <div class="tab" id="t-medidas" onclick="go('medidas')">ğŸ“<small>Medidas</small></div>
    <div class="tab" id="t-fotos" onclick="go('fotos')">ğŸ“¸<small>Fotos</small></div>
  </div>
</div>

<!-- Modal Trocar ExercÃ­cio -->
<div class="modal" id="modalTroca" onclick="fecharModal(event)">
  <div class="sheet" onclick="event.stopPropagation()">
    <div class="shd">
      <div>
        <h3 id="trocaTitulo">Trocar exercÃ­cio</h3>
        <p id="trocaSub">Escolha uma opÃ§Ã£o â€¢ vai ficar padrÃ£o atÃ© vocÃª trocar de novo</p>
      </div>
      <button class="btn2" onclick="closeModal()">Fechar</button>
    </div>
    <div class="sbd" id="trocaOpcoes"></div>
  </div>
</div>

<script>
/* ===========================
   BASE / STORAGE
=========================== */
const hojeISO = ()=> new Date().toISOString().slice(0,10);
const fmtBR = (iso)=> {
  const [y,m,d] = iso.split("-");
  return `${d}/${m}/${y}`;
};

let dados = JSON.parse(localStorage.getItem("miria_sculpt_app") || "null");
if(!dados){
  dados = {
    agua: {},                 // {date:{total, stack[]}}
    proteina: {},             // {date:{total, meta, itens:{...}}}
    intestino: {},            // {date:{foi, chia}}
    medidas: [],              // array {date,peso,cintura,abdomen,gluteo}
    fotos: [],                // array {date, link, obs}
    cargas: {},               // { "SEG|Cadeira Flexora": [{date,kg,reps}] }
    treinoPlano: {}           // { seg:[idx,idx,idx...], ... } seleÃ§Ã£o padrÃ£o por dia/slot
  };
}
function save(){ localStorage.setItem("miria_sculpt_app", JSON.stringify(dados)); }

/* ===========================
   NAVEGAÃ‡ÃƒO
=========================== */
function go(name){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById("sec-"+name).classList.add("active");

  document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active"));
  const tabId = "t-"+(name==="cargas" ? "treino" : name);
  const t = document.getElementById(tabId);
  if(t) t.classList.add("active");

  if(name==="treino") renderTreino();
  if(name==="cargas") renderCargas();
  if(name==="agua") atualizarAgua();
  if(name==="proteina") renderProteinaHoje();
  if(name==="intestino") renderIntestino();
  if(name==="medidas") renderMedidas();
  if(name==="fotos") renderFotos();
  renderInicioKPIs();
}
function renderInicioKPIs(){
  const el = document.getElementById("inicioKPIs");
  const date = hojeISO();

  // Ã¡gua
  const aguaHoje = (dados.agua[date]?.total || 0);
  // proteÃ­na
  const protHoje = (dados.proteina[date]?.total || 0);
  const protMeta = (dados.proteina[date]?.meta || Number(document.getElementById("protMeta")?.value || 95));
  // intestino
  const int = dados.intestino[date];
  const intTxt = int ? (int.foi==="sim" ? "âœ… Sim" : (int.foi==="pouco" ? "ğŸ™‚ Pouco" : "âŒ NÃ£o")) : "â€”";
  // ampulheta (Ãºltima medida)
  let ratio = null;
  if(dados.medidas.length){
    const u = dados.medidas[dados.medidas.length-1];
    const c = Number(u.cintura||0), g = Number(u.gluteo||0);
    if(c>0 && g>0) ratio = (g/c).toFixed(2);
  }

  el.innerHTML = `
    <div class="tag ${aguaHoje>=2000?'ok':(aguaHoje>=1200?'warn':'bad')}">ğŸ’§ <b>${aguaHoje}</b> ml</div>
    <div class="tag ${protHoje>=protMeta?'ok':(protHoje>=protMeta*0.7?'warn':'bad')}">ğŸ¥© <b>${protHoje}</b> g</div>
    <div class="tag">ğŸš½ <b>${intTxt}</b></div>
    <div class="tag">ğŸ‘ Ampulheta: <b>${ratio ?? "â€”"}</b></div>
  `;
}

/* ===========================
   TREINO: BASE + ALTERNATIVAS
   -> PadrÃ£o fica salvo (treinoPlano) atÃ© trocar.
=========================== */

// Lista de dias e estrutura de "slots" (cada slot tem opÃ§Ãµes)
const DIAS = [
  {key:"seg", nome:"SEG", titulo:"Segunda â€¢ GlÃºteo / Posterior ğŸ‘"},
  {key:"ter", nome:"TER", titulo:"TerÃ§a â€¢ Peito + Ombro (colo firme) ğŸ’—"},
  {key:"qua", nome:"QUA", titulo:"Quarta â€¢ QuadrÃ­ceps + GlÃºteo ğŸ”¥"},
  {key:"qui", nome:"QUI", titulo:"Quinta â€¢ Costas + Postura ğŸ§â€â™€ï¸"},
  {key:"sex", nome:"SEX", titulo:"Sexta â€¢ GlÃºteo foco ğŸ‘"}
];

const TREINO_SLOTS = {
  seg: [
    {
      slot:"S1", label:"1ï¸âƒ£ ExercÃ­cio principal (posterior)",
      options:[
        {n:"Cadeira Flexora", s:"3Ã—12", w:"ğŸ‘‰ 20â€“25kg", t:"Controle total. Sem tirar o quadril do banco.", v:"https://www.youtube.com/results?search_query=cadeira+flexora+como+fazer+correto"},
        {n:"Mesa Flexora", s:"4Ã—12", w:"ğŸ‘‰ 18â€“25kg", t:"Sobe forte e desce controlando.", v:"https://www.youtube.com/results?search_query=mesa+flexora+como+fazer+correto"},
        {n:"Flexora em pÃ©", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Concentra no posterior (sem balanÃ§o).", v:"https://www.youtube.com/results?search_query=flexora+em+p%C3%A9+como+fazer"}
      ]
    },
    {
      slot:"S2", label:"2ï¸âƒ£ Hinge (posterior + glÃºteo)",
      options:[
        {n:"Stiff com Halter", s:"3Ã—12", w:"ğŸ‘‰ 6â€“8kg cada lado", t:"Coluna neutra. Desce devagar. Sente alongar posterior.", v:"https://www.youtube.com/results?search_query=stiff+com+halter+como+fazer"},
        {n:"Stiff com barra", s:"3Ã—10", w:"ğŸ‘‰ leve/mÃ©dio", t:"Barra rente ao corpo. Sem curvar lombar.", v:"https://www.youtube.com/results?search_query=stiff+com+barra+como+fazer"},
        {n:"Levantamento terra romeno (mÃ¡quina)", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Sente alongar. Controle total.", v:"https://www.youtube.com/results?search_query=terra+romeno+m%C3%A1quina+como+fazer"}
      ]
    },
    {
      slot:"S3", label:"3ï¸âƒ£ GlÃºteo (principal)",
      options:[
        {n:"ElevaÃ§Ã£o pÃ©lvica (Hip Thrust)", s:"4Ã—10", w:"ğŸ‘‰ 20kg (meta evoluir)", t:"Pausa 1s no topo. NÃ£o arquear lombar.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+p%C3%A9lvica+como+fazer"},
        {n:"Glute Bridge (mÃ¡quina)", s:"4Ã—10", w:"ğŸ‘‰ leve/mÃ©dio", t:"Segura 1s em cima. Queixo baixo.", v:"https://www.youtube.com/results?search_query=glute+bridge+m%C3%A1quina+como+fazer"},
        {n:"Hip Thrust no Smith", s:"4Ã—8â€“10", w:"ğŸ‘‰ mÃ©dio", t:"Trava escÃ¡pulas e controla a descida.", v:"https://www.youtube.com/results?search_query=hip+thrust+smith+como+fazer"}
      ]
    },
    {
      slot:"S4", label:"4ï¸âƒ£ GlÃºteo lateral (modelar)",
      options:[
        {n:"Abdutora mÃ¡quina", s:"3Ã—15", w:"ğŸ‘‰ 30â€“35kg", t:"Inclina levemente pra frente e segura 1s aberta.", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
        {n:"AbduÃ§Ã£o no cabo", s:"3Ã—12", w:"ğŸ‘‰ 5â€“10kg", t:"Leve inclinaÃ§Ã£o do tronco. Controlado.", v:"https://www.youtube.com/results?search_query=abdu%C3%A7%C3%A3o+no+cabo+como+fazer"},
        {n:"Caminhada lateral com elÃ¡stico", s:"3Ã—20 passos", w:"ğŸ‘‰ elÃ¡stico", t:"Sente queimar glÃºteo mÃ©dio.", v:"https://www.youtube.com/results?search_query=caminhada+lateral+com+el%C3%A1stico+gl%C3%BAteo"}
      ]
    },
    {
      slot:"S5", label:"ğŸš¶â€â™€ï¸ Cardio (opcional)",
      options:[
        {n:"Esteira inclinada", s:"12â€“15 min", w:"ğŸ‘‰ leve/moderado", t:"Ajuda barriga sem roubar glÃºteo.", v:"https://www.youtube.com/results?search_query=esteira+inclinada+como+fazer"},
        {n:"Escada (stepmill)", s:"10â€“12 min", w:"ğŸ‘‰ leve/moderado", t:"Postura alta. Sem correr.", v:"https://www.youtube.com/results?search_query=escada+academia+stepmill+como+fazer"},
        {n:"Bicicleta", s:"12â€“15 min", w:"ğŸ‘‰ leve", t:"Ritmo constante.", v:"https://www.youtube.com/results?search_query=bicicleta+ergom%C3%A9trica+como+fazer"}
      ]
    }
  ],

  ter: [
    {
      slot:"T1", label:"1ï¸âƒ£ Peito (inclinado)",
      options:[
        {n:"Supino inclinado mÃ¡quina", s:"3Ã—12", w:"ğŸ‘‰ 15â€“20kg", t:"Peito aberto. Ombros pra baixo.", v:"https://www.youtube.com/results?search_query=supino+inclinado+m%C3%A1quina+como+fazer"},
        {n:"Supino inclinado com halter", s:"3Ã—10â€“12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Controle e amplitude confortÃ¡vel.", v:"https://www.youtube.com/results?search_query=supino+inclinado+halter+como+fazer"},
        {n:"Supino reto mÃ¡quina", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"EscÃ¡pulas firmes no banco.", v:"https://www.youtube.com/results?search_query=supino+reto+m%C3%A1quina+como+fazer"}
      ]
    },
    {
      slot:"T2", label:"2ï¸âƒ£ Peito (abertura)",
      options:[
        {n:"Crucifixo mÃ¡quina", s:"3Ã—12", w:"ğŸ‘‰ 15kg", t:"Controlado. NÃ£o esticar demais.", v:"https://www.youtube.com/results?search_query=crucifixo+m%C3%A1quina+como+fazer"},
        {n:"Crucifixo no cabo", s:"3Ã—12", w:"ğŸ‘‰ leve", t:"Cotovelos levemente flexionados.", v:"https://www.youtube.com/results?search_query=crucifixo+no+cabo+como+fazer"},
        {n:"Peck Deck", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Fecha com controle e pausa 1s.", v:"https://www.youtube.com/results?search_query=peck+deck+como+fazer"}
      ]
    },
    {
      slot:"T3", label:"3ï¸âƒ£ Ombro (lateral)",
      options:[
        {n:"ElevaÃ§Ã£o lateral halter", s:"3Ã—12", w:"ğŸ‘‰ 4kg", t:"Sobe atÃ© linha do ombro. Sem balanÃ§ar.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+lateral+halter+como+fazer"},
        {n:"ElevaÃ§Ã£o lateral na polia", s:"3Ã—12", w:"ğŸ‘‰ leve", t:"TensÃ£o constante. Controla a descida.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+lateral+na+polia+como+fazer"},
        {n:"ElevaÃ§Ã£o lateral mÃ¡quina", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Sem encolher ombro.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+lateral+m%C3%A1quina+como+fazer"}
      ]
    },
    {
      slot:"T4", label:"4ï¸âƒ£ Ombro (press)",
      options:[
        {n:"Desenvolvimento ombro halter", s:"3Ã—10", w:"ğŸ‘‰ 6kg", t:"Controle. NÃ£o jogar a lombar.", v:"https://www.youtube.com/results?search_query=desenvolvimento+ombro+halter+como+fazer"},
        {n:"Desenvolvimento mÃ¡quina", s:"3Ã—10â€“12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Costas coladas no banco.", v:"https://www.youtube.com/results?search_query=desenvolvimento+m%C3%A1quina+como+fazer"},
        {n:"Arnold press", s:"3Ã—10", w:"ğŸ‘‰ leve", t:"Movimento controlado.", v:"https://www.youtube.com/results?search_query=arnold+press+como+fazer"}
      ]
    },
    {
      slot:"T5", label:"â³ Cintura (vÃ¡cuo)",
      options:[
        {n:"VÃ¡cuo abdominal", s:"3Ã—20s", w:"ğŸ‘‰ cintura marcada", t:"Solta o ar e puxa o umbigo pra dentro.", v:"https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer"},
        {n:"Prancha (core)", s:"3Ã—30â€“40s", w:"ğŸ‘‰ core firme", t:"Barriga pra dentro. Sem cair lombar.", v:"https://www.youtube.com/results?search_query=prancha+abdominal+como+fazer"},
        {n:"Dead bug", s:"3Ã—10", w:"ğŸ‘‰ controlado", t:"Coluna neutra. Movimento lento.", v:"https://www.youtube.com/results?search_query=dead+bug+exerc%C3%ADcio+como+fazer"}
      ]
    }
  ],

  qua: [
    {
      slot:"Q1", label:"1ï¸âƒ£ QuadrÃ­ceps (principal)",
      options:[
        {n:"Leg Press", s:"4Ã—12", w:"ğŸ‘‰ 80kg (meta 100â€“110kg)", t:"PÃ© um pouco mais alto. NÃ£o travar joelho.", v:"https://www.youtube.com/results?search_query=leg+press+como+fazer+correto"},
        {n:"Hack squat", s:"4Ã—10â€“12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Desce controlando. Sem tirar lombar.", v:"https://www.youtube.com/results?search_query=hack+squat+como+fazer"},
        {n:"Agachamento guiado (mÃ¡quina)", s:"4Ã—10", w:"ğŸ‘‰ leve/mÃ©dio", t:"PÃ©s firmes. Controle.", v:"https://www.youtube.com/results?search_query=agachamento+guiado+m%C3%A1quina+como+fazer"}
      ]
    },
    {
      slot:"Q2", label:"2ï¸âƒ£ Agachamento",
      options:[
        {n:"Agachamento no Smith", s:"3Ã—10", w:"ğŸ‘‰ 10kg cada lado", t:"PÃ©s levemente Ã  frente. Desce controlado.", v:"https://www.youtube.com/results?search_query=agachamento+no+smith+como+fazer"},
        {n:"Agachamento livre", s:"3Ã—8â€“10", w:"ğŸ‘‰ leve/mÃ©dio", t:"Coluna neutra. Profundidade confortÃ¡vel.", v:"https://www.youtube.com/results?search_query=agachamento+livre+como+fazer"},
        {n:"Agachamento sumÃ´ com halter", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Ponta do pÃ© para fora. Sobe contraindo glÃºteo.", v:"https://www.youtube.com/results?search_query=agachamento+sum%C3%B4+com+halter+como+fazer"}
      ]
    },
    {
      slot:"Q3", label:"3ï¸âƒ£ Extensora",
      options:[
        {n:"Cadeira Extensora", s:"3Ã—12", w:"ğŸ‘‰ 25kg", t:"Sobe forte e desce controlando.", v:"https://www.youtube.com/results?search_query=cadeira+extensora+como+fazer"},
        {n:"Extensora unilateral", s:"3Ã—10", w:"ğŸ‘‰ leve", t:"Concentra no joelho. Controle.", v:"https://www.youtube.com/results?search_query=extensora+unilateral+como+fazer"},
        {n:"Sissy squat (assistido)", s:"3Ã—10", w:"ğŸ‘‰ leve", t:"SÃ³ se nÃ£o sentir joelho.", v:"https://www.youtube.com/results?search_query=sissy+squat+como+fazer"}
      ]
    },
    {
      slot:"Q4", label:"4ï¸âƒ£ GlÃºteo lateral",
      options:[
        {n:"Abdutora", s:"3Ã—15", w:"ğŸ‘‰ 30â€“35kg", t:"Foco no glÃºteo lateral (ajuda ampulheta).", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
        {n:"Coice no cabo", s:"3Ã—12", w:"ğŸ‘‰ 5â€“10kg", t:"Quadril firme. Sobe e contrai.", v:"https://www.youtube.com/results?search_query=coice+no+cabo+gl%C3%BAteo+como+fazer"},
        {n:"GlÃºteo mÃ¡quina (kickback)", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Pausa 1s na contraÃ§Ã£o.", v:"https://www.youtube.com/results?search_query=gl%C3%BAteo+m%C3%A1quina+kickback+como+fazer"}
      ]
    }
  ],

  qui: [
    {
      slot:"K1", label:"1ï¸âƒ£ Costas (puxada)",
      options:[
        {n:"Puxada frente", s:"3Ã—12", w:"ğŸ‘‰ 25kg", t:"Puxa com cotovelos. Ombros pra baixo.", v:"https://www.youtube.com/results?search_query=puxada+frente+na+polia+como+fazer"},
        {n:"Puxada aberta", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Peito aberto. Desce atÃ© o peito.", v:"https://www.youtube.com/results?search_query=puxada+aberta+como+fazer"},
        {n:"Barra assistida", s:"3Ã—8â€“10", w:"ğŸ‘‰ assistÃªncia", t:"Controle e postura.", v:"https://www.youtube.com/results?search_query=barra+assistida+como+fazer"}
      ]
    },
    {
      slot:"K2", label:"2ï¸âƒ£ Costas (remada)",
      options:[
        {n:"Remada baixa", s:"3Ã—12", w:"ğŸ‘‰ 25kg", t:"Segura 1s atrÃ¡s. Postura firme.", v:"https://www.youtube.com/results?search_query=remada+baixa+na+polia+como+fazer"},
        {n:"Remada curvada com halter", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Coluna neutra. Cotovelo pra trÃ¡s.", v:"https://www.youtube.com/results?search_query=remada+curvada+halter+como+fazer"},
        {n:"Remada mÃ¡quina", s:"3Ã—12", w:"ğŸ‘‰ leve/mÃ©dio", t:"Sem elevar ombro.", v:"https://www.youtube.com/results?search_query=remada+m%C3%A1quina+como+fazer"}
      ]
    },
    {
      slot:"K3", label:"3ï¸âƒ£ Postura (ombro/escÃ¡pula)",
      options:[
        {n:"Face Pull", s:"3Ã—15", w:"ğŸ‘‰ leve/mÃ©dio", t:"Postura e colo bonito. Cotovelos altos.", v:"https://www.youtube.com/results?search_query=face+pull+como+fazer"},
        {n:"Remada alta no cabo (leve)", s:"3Ã—12", w:"ğŸ‘‰ leve", t:"SÃ³ postura. Sem dor.", v:"https://www.youtube.com/results?search_query=remada+alta+no+cabo+como+fazer"},
        {n:"Crucifixo invertido", s:"3Ã—12", w:"ğŸ‘‰ leve", t:"ContraÃ§Ã£o nas costas (posterior de ombro).", v:"https://www.youtube.com/results?search_query=crucifixo+invertido+como+fazer"}
      ]
    },
    {
      slot:"K4", label:"4ï¸âƒ£ Core",
      options:[
        {n:"Prancha", s:"3Ã—40s", w:"ğŸ‘‰ core firme", t:"Barriga pra dentro. Sem cair lombar.", v:"https://www.youtube.com/results?search_query=prancha+abdominal+como+fazer"},
        {n:"Abdominal mÃ¡quina", s:"3Ã—15", w:"ğŸ‘‰ leve", t:"Sem puxar pescoÃ§o.", v:"https://www.youtube.com/results?search_query=abdominal+na+m%C3%A1quina+como+fazer"},
        {n:"Pallof press", s:"3Ã—12", w:"ğŸ‘‰ leve", t:"Anti-rotaÃ§Ã£o (cintura mais firme).", v:"https://www.youtube.com/results?search_query=pallof+press+como+fazer"}
      ]
    }
  ],

  sex: [
    {
      slot:"F1", label:"1ï¸âƒ£ GlÃºteo (pesado)",
      options:[
        {n:"ElevaÃ§Ã£o pÃ©lvica (pesado)", s:"4Ã—8", w:"ğŸ‘‰ 30kg (meta 45kg)", t:"Forma perfeita. Pausa no topo.", v:"https://www.youtube.com/results?search_query=hip+thrust+como+fazer"},
        {n:"Hip Thrust no Smith (pesado)", s:"4Ã—8", w:"ğŸ‘‰ mÃ©dio", t:"Controle total. Pausa 1s.", v:"https://www.youtube.com/results?search_query=hip+thrust+smith+como+fazer"},
        {n:"Glute bridge (barra)", s:"4Ã—10", w:"ğŸ‘‰ mÃ©dio", t:"Sem arquear lombar. Queixo baixo.", v:"https://www.youtube.com/results?search_query=glute+bridge+com+barra+como+fazer"}
      ]
    },
    {
      slot:"F2", label:"2ï¸âƒ£ Posterior (hinge)",
      options:[
        {n:"Stiff", s:"3Ã—12", w:"ğŸ‘‰ 8kg cada lado", t:"Controle, coluna neutra.", v:"https://www.youtube.com/results?search_query=stiff+com+halter+como+fazer"},
        {n:"Terra romeno (barra)", s:"3Ã—10", w:"ğŸ‘‰ leve/mÃ©dio", t:"Barra rente ao corpo.", v:"https://www.youtube.com/results?search_query=terra+romeno+com+barra+como+fazer"},
        {n:"Good morning (leve)", s:"3Ã—10", w:"ğŸ‘‰ leve", t:"SÃ³ se dominar a tÃ©cnica.", v:"https://www.youtube.com/results?search_query=good+morning+exerc%C3%ADcio+como+fazer"}
      ]
    },
    {
      slot:"F3", label:"3ï¸âƒ£ GlÃºteo (unilateral)",
      options:[
        {n:"Afundo andando", s:"3Ã—10 cada perna", w:"ğŸ‘‰ 4â€“6kg", t:"Tronco levemente Ã  frente, calcanhar empurra.", v:"https://www.youtube.com/results?search_query=afundo+andando+como+fazer"},
        {n:"Passada no Smith", s:"3Ã—10", w:"ğŸ‘‰ leve/mÃ©dio", t:"Controle e amplitude.", v:"https://www.youtube.com/results?search_query=passada+no+smith+como+fazer"},
        {n:"BÃºlgaro", s:"3Ã—8â€“10", w:"ğŸ‘‰ leve", t:"Foco no glÃºteo. Desce controlando.", v:"https://www.youtube.com/results?search_query=agachamento+b%C3%BAlgaro+como+fazer"}
      ]
    },
    {
      slot:"F4", label:"4ï¸âƒ£ GlÃºteo lateral",
      options:[
        {n:"Abdutora", s:"4Ã—15", w:"ğŸ‘‰ 35â€“40kg", t:"Segura 1s aberta. GlÃºteo lateral.", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
        {n:"AbduÃ§Ã£o no cabo", s:"3Ã—12", w:"ğŸ‘‰ 5â€“10kg", t:"Sem girar quadril.", v:"https://www.youtube.com/results?search_query=abdu%C3%A7%C3%A3o+no+cabo+como+fazer"},
        {n:"Kickback no cabo", s:"3Ã—12", w:"ğŸ‘‰ 5â€“10kg", t:"Pausa 1s contraindo.", v:"https://www.youtube.com/results?search_query=coice+no+cabo+gl%C3%BAteo+como+fazer"}
      ]
    },
    {
      slot:"F5", label:"â³ Cintura (vÃ¡cuo)",
      options:[
        {n:"VÃ¡cuo abdominal", s:"3Ã—20s", w:"ğŸ‘‰ cintura", t:"ConsistÃªncia 3x/semana.", v:"https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer"},
        {n:"Prancha", s:"3Ã—40s", w:"ğŸ‘‰ core", t:"Barriga pra dentro.", v:"https://www.youtube.com/results?search_query=prancha+abdominal+como+fazer"},
        {n:"Pallof press", s:"3Ã—12", w:"ğŸ‘‰ leve", t:"Anti-rotaÃ§Ã£o.", v:"https://www.youtube.com/results?search_query=pallof+press+como+fazer"}
      ]
    }
  ]
};

// garante padrÃ£o inicial: opÃ§Ã£o 0 de cada slot (se nÃ£o houver seleÃ§Ã£o salva)
function ensurePlano(){
  if(!dados.treinoPlano) dados.treinoPlano = {};
  DIAS.forEach(d=>{
    if(!dados.treinoPlano[d.key]){
      dados.treinoPlano[d.key] = TREINO_SLOTS[d.key].map(()=>0);
    } else {
      // se mudou estrutura, ajusta tamanho
      const need = TREINO_SLOTS[d.key].length;
      while(dados.treinoPlano[d.key].length < need) dados.treinoPlano[d.key].push(0);
      if(dados.treinoPlano[d.key].length > need) dados.treinoPlano[d.key] = dados.treinoPlano[d.key].slice(0, need);
    }
  });
  save();
}
ensurePlano();

let diaAtivo = "seg";
function renderDiasChips(){
  const el = document.getElementById("chipsDias");
  el.innerHTML = "";
  DIAS.forEach(d=>{
    const c = document.createElement("div");
    c.className = "chip"+(d.key===diaAtivo?" active":"");
    c.textContent = d.nome;
    c.onclick = ()=>{ diaAtivo = d.key; renderTreino(); };
    el.appendChild(c);
  });
}
renderDiasChips();

function getSelecionado(dayKey, idxSlot){
  const sel = dados.treinoPlano?.[dayKey]?.[idxSlot] ?? 0;
  const slot = TREINO_SLOTS[dayKey][idxSlot];
  return slot.options[Math.max(0, Math.min(sel, slot.options.length-1))];
}

let trocaCtx = null; // {dayKey, idxSlot}
function openTroca(dayKey, idxSlot){
  trocaCtx = {dayKey, idxSlot};
  const slot = TREINO_SLOTS[dayKey][idxSlot];

  document.getElementById("trocaTitulo").textContent = `Trocar: ${slot.label}`;
  document.getElementById("trocaSub").textContent = `Escolha uma opÃ§Ã£o â€¢ vai ficar padrÃ£o atÃ© vocÃª trocar de novo âœ…`;

  const wrap = document.getElementById("trocaOpcoes");
  wrap.innerHTML = "";

  slot.options.forEach((op, i)=>{
    const div = document.createElement("div");
    div.className = "opt";
    div.innerHTML = `<b>${op.n}</b><span>${op.s} â€¢ ${op.w}</span>`;
    div.onclick = ()=> {
      // salva como padrÃ£o
      dados.treinoPlano[dayKey][idxSlot] = i;
      save();
      closeModal();
      renderTreino();
      renderCargasSelectors(); // para cargas ver exercÃ­cio atualizado
    };
    wrap.appendChild(div);
  });

  document.getElementById("modalTroca").classList.add("open");
}
function closeModal(){
  document.getElementById("modalTroca").classList.remove("open");
  trocaCtx = null;
}
function fecharModal(e){ closeModal(); }

function renderTreino(){
  renderDiasChips();
  const day = DIAS.find(d=>d.key===diaAtivo);
  const list = document.getElementById("listaTreino");
  list.innerHTML = "";

  // cabeÃ§alho do dia
  const head = document.createElement("div");
  head.className = "item";
  head.innerHTML = `
    <h3>${day.titulo}</h3>
    <div class="meta">Clique em <b>â€œVer vÃ­deo (PT)â€</b> para execuÃ§Ã£o correta â€¢ Troca fica salva como padrÃ£o âœ…</div>
  `;
  list.appendChild(head);

  // exercÃ­cios do dia
  const slots = TREINO_SLOTS[diaAtivo];
  slots.forEach((slot, idx)=>{
    const ex = getSelecionado(diaAtivo, idx);

    // status carga (se tem histÃ³rico)
    const key = `${day.nome}|${ex.n}`;
    const has = (dados.cargas[key]?.length || 0) > 0;

    const div = document.createElement("div");
    div.className = "item";
    div.innerHTML = `
      <h3>${ex.n} <span class="small" style="float:right;opacity:.9">${has ? "âœ… com histÃ³rico" : "â€” sem registro ainda"}</span></h3>
      <div class="meta">${ex.s} â€¢ ${ex.w}</div>
      <div class="hint">ğŸ’¡ ${ex.t}</div>
      <div class="row" style="margin-top:10px">
        <a href="${ex.v}" target="_blank">â–¶ Ver vÃ­deo (PT)</a>
        <button class="btn2" onclick="openTroca('${diaAtivo}', ${idx})">ğŸ” Trocar exercÃ­cio</button>
      </div>
    `;
    list.appendChild(div);
  });

  // atualiza selects do registrar cargas conforme o dia ativo
  renderCargasSelectors();
}

/* ===========================
   CARGAS
=========================== */
function renderCargas(){
  renderCargasSelectors();
  renderHistCargas();
}
function renderCargasSelectors(){
  const cDia = document.getElementById("cDia");
  const cEx = document.getElementById("cEx");
  if(!cDia || !cEx) return;

  // dias
  cDia.innerHTML = "";
  DIAS.forEach(d=>{
    const o = document.createElement("option");
    o.value = d.key;
    o.textContent = `${d.nome} â€¢ ${d.titulo.split("â€¢")[1]?.trim() || ""}`;
    if(d.key === diaAtivo) o.selected = true;
    cDia.appendChild(o);
  });

  // exercÃ­cios do dia selecionado
  const dayKey = cDia.value;
  cEx.innerHTML = "";
  TREINO_SLOTS[dayKey].forEach((slot, idx)=>{
    const ex = getSelecionado(dayKey, idx);
    const o = document.createElement("option");
    o.value = ex.n;
    o.textContent = ex.n;
    cEx.appendChild(o);
  });

  cDia.onchange = ()=> renderCargasSelectors();
  cEx.onchange = ()=> renderHistCargas();
}
function salvarCarga(){
  const dayKey = document.getElementById("cDia").value;
  const dayNome = DIAS.find(d=>d.key===dayKey).nome;
  const ex = document.getElementById("cEx").value;
  const kg = Number(document.getElementById("cKg").value || 0);
  const reps = (document.getElementById("cRep").value || "").trim();

  if(!ex || kg<=0) { alert("Coloque pelo menos a carga (kg)."); return; }

  const key = `${dayNome}|${ex}`;
  if(!dados.cargas[key]) dados.cargas[key] = [];
  dados.cargas[key].push({date: hojeISO(), kg, reps});
  save();

  document.getElementById("cKg").value = "";
  document.getElementById("cRep").value = "";
  renderHistCargas();
  renderTreino();
}
function limparCargasDia(){
  const dayKey = document.getElementById("cDia").value;
  const dayNome = DIAS.find(d=>d.key===dayKey).nome;

  // remove todas as chaves desse dia
  Object.keys(dados.cargas).forEach(k=>{
    if(k.startsWith(dayNome+"|")) delete dados.cargas[k];
  });
  save();
  renderHistCargas();
  renderTreino();
}
function renderHistCargas(){
  const dayKey = document.getElementById("cDia")?.value;
  const dayNome = DIAS.find(d=>d.key===dayKey)?.nome;
  const ex = document.getElementById("cEx")?.value;
  if(!dayNome || !ex) return;

  const key = `${dayNome}|${ex}`;
  const arr = (dados.cargas[key] || []).slice().reverse().slice(0,12);
  const el = document.getElementById("histCargas");
  if(!arr.length){
    el.innerHTML = "Sem registros ainda.";
    return;
  }
  el.innerHTML = arr.map(r=>{
    const reps = r.reps ? ` â€¢ reps: <b>${r.reps}</b>` : "";
    return `ğŸ“Œ <b>${fmtBR(r.date)}</b> â€¢ <b>${r.kg}kg</b>${reps}`;
  }).join("<br>");
}

/* ===========================
   ÃGUA
=========================== */
function ensureAguaHoje(){
  const d = hojeISO();
  if(!dados.agua[d]) dados.agua[d] = {total:0, stack:[]};
}
function addAgua(v){
  ensureAguaHoje();
  dados.agua[hojeISO()].total += v;
  dados.agua[hojeISO()].stack.push(v);
  save();
  atualizarAgua();
  renderInicioKPIs();
}
function addAguaManual(){
  const v = Number(document.getElementById("aguaManual").value || 0);
  if(v<=0) return;
  document.getElementById("aguaManual").value = "";
  addAgua(v);
}
function desfazerAgua(){
  ensureAguaHoje();
  const st = dados.agua[hojeISO()].stack;
  const last = st.pop();
  if(last) dados.agua[hojeISO()].total = Math.max(0, dados.agua[hojeISO()].total - last);
  save();
  atualizarAgua();
  renderInicioKPIs();
}
function zerarAgua(){
  const d = hojeISO();
  dados.agua[d] = {total:0, stack:[]};
  save();
  atualizarAgua();
  renderInicioKPIs();
}
function atualizarAgua(){
  ensureAguaHoje();
  const meta = Number(document.getElementById("aguaMeta").value || 2500);
  const total = dados.agua[hojeISO()].total || 0;
  const falta = Math.max(0, meta - total);

  document.getElementById("aguaHoje").textContent = total;
  document.getElementById("aguaFalta").textContent = falta;

  let pct = meta>0 ? (total/meta)*100 : 0;
  pct = Math.min(100, Math.max(0, pct));
  document.getElementById("aguaBar").style.width = pct + "%";

  // mÃ©dia 7 dias
  let soma=0, dias=0;
  for(let i=0;i<7;i++){
    const d = new Date(); d.setDate(d.getDate()-i);
    const key = d.toISOString().slice(0,10);
    if(dados.agua[key]){
      soma += (dados.agua[key].total || 0);
      dias++;
    }
  }
  document.getElementById("aguaMedia7").textContent = dias ? Math.round(soma/dias) : 0;
}

/* ===========================
   PROTEÃNA (AUTO)
=========================== */
function calcProteina(){
  const d = hojeISO();
  const meta = Number(document.getElementById("protMeta").value || 95);

  const fr = Number(document.getElementById("pFrango").value || 0);
  const ca = Number(document.getElementById("pCarne").value || 0);
  const ov = Number(document.getElementById("pOvo").value || 0);
  const io = Number(document.getElementById("pIog").value || 0);
  const qu = Number(document.getElementById("pQueijo").value || 0);
  const wh = Number(document.getElementById("pWhey").value || 0);

  const total =
    (fr/100)*31 +
    (ca/100)*26 +
    (ov*6) +
    (io*10) +
    (qu/100)*25 +
    (wh*20);

  dados.proteina[d] = {
    meta,
    total: Math.round(total),
    itens: {fr, ca, ov, io, qu, wh}
  };
  save();
  renderProteinaHoje();
  renderInicioKPIs();
}
function zerarProteina(){
  delete dados.proteina[hojeISO()];
  save();
  renderProteinaHoje();
  renderInicioKPIs();
}
function renderProteinaHoje(){
  const d = hojeISO();
  const obj = dados.proteina[d];

  // se tiver salvo, repÃµe campos
  if(obj?.itens){
    document.getElementById("protMeta").value = obj.meta ?? 95;
    document.getElementById("pFrango").value = obj.itens.fr ?? "";
    document.getElementById("pCarne").value  = obj.itens.ca ?? "";
    document.getElementById("pOvo").value    = obj.itens.ov ?? "";
    document.getElementById("pIog").value    = obj.itens.io ?? "";
    document.getElementById("pQueijo").value = obj.itens.qu ?? "";
    document.getElementById("pWhey").value   = obj.itens.wh ?? "";
  }

  const meta = Number(document.getElementById("protMeta").value || 95);
  const total = obj?.total ?? 0;
  const falta = Math.max(0, meta-total);

  let pct = meta>0 ? (total/meta)*100 : 0;
  pct = Math.min(100, Math.max(0, pct));
  document.getElementById("protBar").style.width = pct + "%";

  const k = document.getElementById("protKPIs");
  const cls = total>=meta ? "ok" : (total>=meta*0.7 ? "warn" : "bad");
  k.innerHTML = `
    <div class="tag ${cls}">Hoje: <b>${total}g</b></div>
    <div class="tag">Meta: <b>${meta}g</b></div>
    <div class="tag ${falta===0?'ok':'warn'}">Faltam: <b>${falta}g</b></div>
  `;

  // mÃ©dia 7 dias
  let soma=0, dias=0;
  for(let i=0;i<7;i++){
    const dt = new Date(); dt.setDate(dt.getDate()-i);
    const key = dt.toISOString().slice(0,10);
    if(dados.proteina[key]){
      soma += (dados.proteina[key].total || 0);
      dias++;
    }
  }
  const media = dias ? Math.round(soma/dias) : 0;
  document.getElementById("protMedia7").innerHTML = `MÃ©dia Ãºltimos 7 dias: <b>${media}g</b>`;
}

/* ===========================
   INTESTINO
=========================== */
function salvarIntestino(){
  const d = hojeISO();
  dados.intestino[d] = {
    foi: document.getElementById("intSel").value,
    chia: document.getElementById("chiaSel").checked
  };
  save();
  renderIntestino();
  renderInicioKPIs();
}
function limparIntestino(){
  delete dados.intestino[hojeISO()];
  save();
  renderIntestino();
  renderInicioKPIs();
}
function renderIntestino(){
  const d = hojeISO();
  const obj = dados.intestino[d];
  document.getElementById("intSel").value = obj?.foi ?? "nao";
  document.getElementById("chiaSel").checked = !!obj?.chia;

  const entries = Object.entries(dados.intestino)
    .sort((a,b)=> a[0]<b[0]?-1:1)
    .slice(-10)
    .reverse();

  const el = document.getElementById("histInt");
  if(!entries.length){ el.innerHTML="Sem registros ainda."; return; }
  el.innerHTML = entries.map(([date,val])=>{
    const foi = val.foi==="sim" ? "âœ… Sim" : (val.foi==="pouco" ? "ğŸ™‚ Pouco" : "âŒ NÃ£o");
    const chia = val.chia ? " + ğŸŒ¿ chia" : "";
    return `ğŸ“Œ <b>${fmtBR(date)}</b> â€” ${foi}${chia}`;
  }).join("<br>");
}

/* ===========================
   MEDIDAS
=========================== */
function salvarMedidas(){
  const d = hojeISO();
  const obj = {
    date: d,
    peso: Number(document.getElementById("mPeso").value || 0),
    cintura: Number(document.getElementById("mCint").value || 0),
    abdomen: Number(document.getElementById("mAbd").value || 0),
    gluteo: Number(document.getElementById("mGlu").value || 0)
  };
  // remove medida do mesmo dia (se existir) e adiciona atual
  dados.medidas = dados.medidas.filter(x=>x.date!==d);
  dados.medidas.push(obj);
  dados.medidas.sort((a,b)=> a.date<b.date?-1:1);
  save();
  renderMedidas();
  renderInicioKPIs();
}
function limparMedidasHoje(){
  const d = hojeISO();
  dados.medidas = dados.medidas.filter(x=>x.date!==d);
  save();
  renderMedidas();
  renderInicioKPIs();
}
function renderMedidas(){
  // preenche com Ãºltima
  if(dados.medidas.length){
    const u = dados.medidas[dados.medidas.length-1];
    document.getElementById("mPeso").value = u.peso || "";
    document.getElementById("mCint").value = u.cintura || "";
    document.getElementById("mAbd").value  = u.abdomen || "";
    document.getElementById("mGlu").value  = u.gluteo || "";
  }

  // ampulheta
  const el = document.getElementById("ampInfo");
  if(!dados.medidas.length){
    el.innerHTML = "Sem medidas salvas ainda.";
  } else {
    const u = dados.medidas[dados.medidas.length-1];
    const c = Number(u.cintura||0), g = Number(u.gluteo||0);
    if(c<=0 || g<=0){
      el.innerHTML = "Preencha cintura e glÃºteo para calcular.";
    } else {
      const ratio = g/c;
      let nota="Boa", cls="warn";
      if(ratio>=1.32){ nota="ğŸ”¥ Ampulheta forte"; cls="ok"; }
      else if(ratio>=1.25){ nota="âœ¨ Ampulheta em construÃ§Ã£o"; cls="warn"; }
      else { nota="ğŸ“Œ Foco em glÃºteo + core"; cls="bad"; }
      el.innerHTML = `
        ProporÃ§Ã£o: <b>${ratio.toFixed(2)}</b> (GlÃºteo Ã· Cintura) <br>
        <span class="tag ${cls}" style="display:inline-block;margin-top:8px">${nota}</span>
        <div class="small" style="margin-top:10px">Ãšltima: <b>${fmtBR(u.date)}</b> â€¢ Cintura ${c}cm â€¢ GlÃºteo ${g}cm</div>
      `;
    }
  }

  // "grÃ¡fico" simples em texto (pra nÃ£o depender de libs)
  const t = document.getElementById("gluChartText");
  if(dados.medidas.length < 2){
    t.innerHTML = "Salve pelo menos 2 registros para ver evoluÃ§Ã£o.";
  } else {
    const last = dados.medidas.slice(-8);
    t.innerHTML = last.map(x=>`ğŸ“Œ <b>${fmtBR(x.date)}</b> â€” glÃºteo: <b>${x.gluteo||0}cm</b> â€¢ cintura: ${x.cintura||0}cm`).join("<br>");
  }
}

/* ===========================
   FOTOS
=========================== */
function salvarFoto(){
  const link = (document.getElementById("fotoLink").value||"").trim();
  if(!link){ alert("Cole o link da foto."); return; }
  const obs = (document.getElementById("fotoObs").value||"").trim();
  dados.fotos.push({date: hojeISO(), link, obs});
  save();
  document.getElementById("fotoLink").value="";
  document.getElementById("fotoObs").value="";
  renderFotos();
}
function limparFotos(){
  if(!confirm("Tem certeza que quer apagar TODAS as fotos salvas no app?")) return;
  dados.fotos = [];
  save();
  renderFotos();
}
function renderFotos(){
  const el = document.getElementById("histFotos");
  if(!dados.fotos.length){ el.innerHTML="Sem fotos salvas ainda."; return; }
  const list = dados.fotos.slice().reverse().slice(0,20);
  el.innerHTML = list.map(f=>{
    const obs = f.obs ? ` â€¢ <i>${f.obs}</i>` : "";
    return `ğŸ“Œ <b>${fmtBR(f.date)}</b>${obs}<br><a href="${f.link}" target="_blank">Abrir foto</a>`;
  }).join("<br><br>");
}

/* ===========================
   INIT
=========================== */
renderTreino();
atualizarAgua();
renderProteinaHoje();
renderIntestino();
renderMedidas();
renderFotos();
renderCargas();
renderInicioKPIs();

// registra Service Worker se existir (PWA)
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('./sw.js').catch(()=>{});
}
</script>
</body>
</html>
