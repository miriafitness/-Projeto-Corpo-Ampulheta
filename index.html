<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <meta name="theme-color" content="#0b0b10" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>Miri√£ Sculpt‚Ñ¢</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="icon" href="icon-192.png" />
  <link rel="apple-touch-icon" href="icon-192.png" />

  <style>
    :root{
      --bg:#0b0b10;
      --bg2:#12121a;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.12);
      --text:#f4f4f7;
      --muted:rgba(244,244,247,.72);

      /* Luxo (B): preto + dourado + rosa suave */
      --rose:#ff3e8e;
      --rose2:#ff6aa8;
      --gold:#d6b36a;
      --gold2:#f0d89b;

      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --radius: 22px;
      --radius2: 18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 600px at 30% 0%, rgba(255,62,142,.22), transparent 55%),
        radial-gradient(900px 500px at 90% 10%, rgba(214,179,106,.18), transparent 55%),
        linear-gradient(180deg, var(--bg), #07070b 55%, var(--bg));
      padding:16px 14px 90px;
      max-width: 980px;
      margin: 0 auto;
    }

    /* Topo */
    .top{
      display:flex; gap:14px; align-items:flex-start; justify-content:space-between;
      padding: 10px 2px 12px;
    }
    .brand{
      display:flex; gap:12px; align-items:center;
      min-width: 0;
    }
    .avatar{
      width:52px; height:52px; border-radius:16px;
      background: radial-gradient(circle at 30% 20%, rgba(255,62,142,.35), transparent 55%),
                  radial-gradient(circle at 80% 30%, rgba(214,179,106,.35), transparent 55%),
                  rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      display:grid; place-items:center;
      flex: 0 0 auto;
    }
    .avatar span{font-size:24px}
    .titlewrap{min-width:0}
    h1{
      margin:0;
      font-size: 22px;
      letter-spacing:.2px;
      line-height:1.15;
    }
    .subtitle{
      margin-top:6px;
      color:var(--muted);
      font-size: 13px;
      line-height:1.25;
    }

    .pill{
      user-select:none;
      display:inline-flex; align-items:center; justify-content:center;
      padding:10px 12px;
      border-radius: 999px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--text);
      font-size: 12px;
      white-space: nowrap;
      box-shadow: 0 10px 30px rgba(0,0,0,.28);
    }

    /* Cards */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.05));
      border: 1px solid rgba(255,255,255,.10);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      margin: 12px 0;
      overflow:hidden;
    }

    .card h2{
      margin:0 0 10px;
      font-size: 16px;
      letter-spacing:.2px;
      display:flex; align-items:center; gap:8px;
    }

    .muted{ color: var(--muted); font-size: 13px; line-height:1.3; }

    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .grid2{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    @media (max-width:700px){
      .grid2{grid-template-columns:1fr}
    }

    .btn{
      border:0;
      cursor:pointer;
      border-radius: 16px;
      padding: 12px 14px;
      color: #fff;
      font-weight: 700;
      background: linear-gradient(135deg, var(--rose), var(--rose2));
      box-shadow: 0 14px 35px rgba(255,62,142,.20);
    }
    .btn.secondary{
      background: rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.12);
      color: var(--text);
      font-weight: 650;
      box-shadow:none;
    }
    .btn.gold{
      background: linear-gradient(135deg, var(--gold), var(--gold2));
      color:#151515;
      box-shadow: 0 14px 35px rgba(214,179,106,.18);
    }
    .btn:active{ transform: translateY(1px); }

    input, select, textarea{
      width:100%;
      padding: 12px 12px;
      border-radius: 16px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.24);
      color: var(--text);
      outline:none;
    }
    input::placeholder, textarea::placeholder{ color: rgba(244,244,247,.48); }

    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top: 10px;
    }
    .kpi .box{
      border-radius: 18px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      padding: 12px;
    }
    .kpi .big{font-size: 20px; font-weight: 800;}
    .kpi .small{font-size: 12px; color: var(--muted); margin-top: 4px;}

    /* Barra de progresso */
    .progress{
      margin-top: 10px;
      height: 14px;
      border-radius: 999px;
      background: rgba(255,255,255,.10);
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--rose), var(--gold2));
      transition: .25s;
    }

    /* Atalhos */
    .shortcuts{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top: 10px;
    }
    .shortcut{
      flex: 1 1 150px;
      border-radius: 18px;
      padding: 14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      cursor:pointer;
      display:flex; gap:10px; align-items:center; justify-content:center;
      font-weight: 800;
    }
    .shortcut.rose{
      background: linear-gradient(135deg, rgba(255,62,142,.92), rgba(255,106,168,.72));
      border: 1px solid rgba(255,255,255,.12);
      color:#fff;
    }

    /* Abas de dia (Treino) */
    .tabs{
      display:flex; gap:8px; flex-wrap:wrap;
      margin: 10px 0 12px;
    }
    .tab{
      padding: 10px 12px;
      border-radius: 16px;
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      color: var(--text);
      font-weight: 800;
      cursor:pointer;
      min-width: 62px;
      text-align:center;
    }
    .tab.active{
      background: linear-gradient(135deg, rgba(255,62,142,.38), rgba(214,179,106,.22));
      border-color: rgba(255,255,255,.16);
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }

    /* Lista de exerc√≠cios */
    .ex{
      padding: 12px;
      border-radius: 18px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.09);
      margin: 10px 0;
    }
    .exTop{
      display:flex; justify-content:space-between; gap:10px; align-items:flex-start;
    }
    .exName{ font-weight: 900; }
    .exMeta{ color: var(--muted); font-size: 13px; margin-top: 6px; }
    .exTip{ color: rgba(244,244,247,.78); font-size: 13px; margin-top: 8px; }
    .ex a{
      display:inline-block;
      margin-top: 10px;
      color: var(--gold2);
      font-weight: 800;
      text-decoration:none;
    }

    /* Navega√ß√£o inferior */
    .nav{
      position: fixed;
      left: 0; right: 0; bottom: 0;
      padding: 10px 12px 14px;
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.70) 30%, rgba(0,0,0,.86));
      backdrop-filter: blur(10px);
    }
    .navInner{
      max-width: 980px;
      margin: 0 auto;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
    }
    .navBtn{
      border-radius: 18px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding: 12px 8px;
      text-align:center;
      font-weight: 900;
      cursor:pointer;
      display:flex; flex-direction:column; gap:6px;
      box-shadow: 0 18px 40px rgba(0,0,0,.25);
    }
    .navBtn span{ font-size: 22px; }
    .navBtn small{ font-size: 12px; color: rgba(244,244,247,.78); }
    .navBtn.active{
      background: linear-gradient(135deg, rgba(255,62,142,.35), rgba(214,179,106,.16));
      border-color: rgba(255,255,255,.16);
    }

    /* Se√ß√µes */
    .section{ display:none; }
    .section.active{ display:block; }

    /* Canvas gr√°fico (escuro) */
    canvas{
      width:100%;
      max-height: 260px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.10);
      border-radius: 18px;
      padding: 10px;
    }

    /* Fotos */
    .photoGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    @media(max-width:700px){ .photoGrid{grid-template-columns:1fr;} }
    .photoCard{
      border-radius: 18px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.05);
      padding: 12px;
    }
    .photoCard img{
      width:100%;
      border-radius: 14px;
      display:block;
    }
    .photoMeta{ margin-top: 8px; color: var(--muted); font-size: 12px; }

    .note{
      padding: 12px;
      border-radius: 18px;
      background: rgba(214,179,106,.10);
      border:1px solid rgba(214,179,106,.22);
      color: rgba(244,244,247,.92);
      font-size: 13px;
      line-height:1.35;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <div class="top">
    <div class="brand">
      <div class="avatar"><span>üçë</span></div>
      <div class="titlewrap">
        <h1>Miri√£ Sculpt‚Ñ¢</h1>
        <div class="subtitle">Esculpindo curvas com estrat√©gia.</div>
        <div class="subtitle">Treino + cargas + √°gua + prote√≠na + intestino + medidas + fotos ‚Ä¢ salva no seu celular</div>
      </div>
    </div>
    <div class="pill">‚ú® Premium</div>
  </div>

  <!-- ATALHOS -->
  <div class="card">
    <h2>‚ö° Atalhos <span class="muted">um toque e pronto</span></h2>
    <div class="shortcuts">
      <div class="shortcut rose" onclick="go('agua')">üíß √Ågua</div>
      <div class="shortcut rose" onclick="go('proteina')">ü•© Prote√≠na</div>
      <div class="shortcut rose" onclick="go('intestino')">üöΩ Intestino</div>
      <div class="shortcut rose" onclick="go('medidas')">üìè Medidas</div>
      <div class="shortcut" onclick="go('peito')">üíó Peito firme</div>
    </div>
  </div>

  <!-- IN√çCIO -->
  <section id="sec-inicio" class="section active">
    <div class="card">
      <h2>üéØ Foco Ampulheta (B)</h2>
      <div class="muted">Costas + postura + core (v√°cuo) + gl√∫teo (hip thrust) = cintura mais marcada com estrat√©gia.</div>

      <div class="kpi">
        <div class="box">
          <div class="big" id="kpiRatio">‚Äî</div>
          <div class="small">Propor√ß√£o (gl√∫teo √∑ cintura)</div>
        </div>
        <div class="box">
          <div class="big" id="kpiNota">‚Äî</div>
          <div class="small">Nota ampulheta</div>
        </div>
      </div>

      <div class="note">
        üì∏ <b>Fotos:</b> 1x a cada <b>14 dias</b> (mesma luz, mesmo lugar, mesma pose).<br/>
        üìè <b>Medidas:</b> 1x por <b>semana</b> (de prefer√™ncia de manh√£, em jejum).<br/>
        üçë <b>Gl√∫teo:</b> o ‚Äúsegredo‚Äù √© consist√™ncia + progress√£o leve (subir carga quando ficar f√°cil).
      </div>
    </div>

    <div class="card">
      <h2>üçë Gr√°fico de evolu√ß√£o do gl√∫teo</h2>
      <div class="muted">Ele usa as medidas que voc√™ salva em ‚ÄúMedidas‚Äù.</div>
      <div style="margin-top:10px;">
        <canvas id="chartGluteo" height="240"></canvas>
      </div>
    </div>
  </section>

  <!-- TREINO -->
  <section id="sec-treino" class="section">
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <div>
          <h2>üìÖ Treino SEG‚ÄìSEX (Ampulheta)</h2>
          <div class="muted">Clique no dia. Links em PT + espa√ßo pra salvar suas cargas/rep.</div>
        </div>
        <button class="btn secondary" onclick="go('cargas')">üìù Registrar cargas</button>
      </div>

      <div class="tabs" id="tabsDias"></div>

      <div class="note" style="background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.10);">
        ‚è±Ô∏è <b>Descanso:</b> principais 1m‚Äì1m30 ‚Ä¢ acess√≥rios 45s‚Äì1m<br/>
        üçë <b>Regra:</b> se completou reps com folga ‚Üí <b>sobe peso</b> na pr√≥xima<br/>
        üß† <b>T√©cnica perfeita</b> vale mais que carga
      </div>

      <div id="treinoLista"></div>
    </div>
  </section>

  <!-- √ÅGUA -->
  <section id="sec-agua" class="section">
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <h2>üíß √Ågua</h2>
        <button class="btn secondary" onclick="aguaZerar()">üßπ Zerar hoje</button>
      </div>

      <div class="grid2">
        <div>
          <label class="muted">üéØ Meta di√°ria (ml)</label>
          <input type="number" id="aguaMeta" value="2500" />
        </div>
        <div>
          <label class="muted">‚ûï Adicionar manualmente (ml)</label>
          <input type="number" id="aguaManual" placeholder="Ex: 300" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="aguaAddManual()">‚ûï Somar</button>
        <button class="btn secondary" onclick="aguaAdd(470)">+470</button>
        <button class="btn secondary" onclick="aguaAdd(250)">+250</button>
        <button class="btn secondary" onclick="aguaDesfazer()">‚Ü©Ô∏è Desfazer</button>
      </div>

      <div class="progress"><div class="bar" id="aguaBar"></div></div>

      <div class="kpi">
        <div class="box">
          <div class="big" id="aguaHoje">0 ml</div>
          <div class="small">Hoje</div>
        </div>
        <div class="box">
          <div class="big" id="aguaMedia7">0 ml</div>
          <div class="small">M√©dia (7 dias)</div>
        </div>
      </div>
    </div>
  </section>

  <!-- PROTE√çNA -->
  <section id="sec-proteina" class="section">
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <div>
          <h2>ü•© Prote√≠na (autom√°tica)</h2>
          <div class="muted">Escolha o alimento + coloque quantidade. O app calcula e soma.</div>
        </div>
        <button class="btn secondary" onclick="protZerar()">üßπ Zerar hoje</button>
      </div>

      <div class="grid2">
        <div>
          <label class="muted">üéØ Meta de prote√≠na (g/dia)</label>
          <input type="number" id="protMeta" value="100" />
        </div>
        <div>
          <label class="muted">üìÖ Data</label>
          <input type="text" id="protData" disabled />
        </div>
      </div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">üçΩÔ∏è Alimento</label>
          <select id="protFood">
            <option value="frango">üçó Frango (31g / 100g)</option>
            <option value="carne">ü•© Carne (26g / 100g)</option>
            <option value="ovo">ü•ö Ovo (6g / unidade)</option>
            <option value="iog">ü•õ Iogurte (10g / unidade)</option>
            <option value="queijo">üßÄ Queijo (25g / 100g)</option>
            <option value="whey">ü•§ Whey (20g / scoop)</option>
          </select>
        </div>
        <div>
          <label class="muted">‚úçÔ∏è Quantidade</label>
          <input type="number" id="protQtd" placeholder="Ex: 150 (g) ou 2 (ovos)" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="protAdd()">‚ûï Adicionar</button>
        <button class="btn secondary" onclick="protDesfazer()">‚Ü©Ô∏è Desfazer</button>
      </div>

      <div class="progress"><div class="bar" id="protBar"></div></div>

      <div class="kpi">
        <div class="box">
          <div class="big" id="protHoje">0 g</div>
          <div class="small">Prote√≠na hoje</div>
        </div>
        <div class="box">
          <div class="big" id="protFaltam">‚Äî</div>
          <div class="small">Faltam para meta</div>
        </div>
      </div>

      <div class="card" style="margin:12px 0 0; background: rgba(255,255,255,.05); border-color: rgba(255,255,255,.10);">
        <h2 style="margin:0 0 8px;">üßæ Itens de hoje</h2>
        <div id="protLista" class="muted"></div>
      </div>
    </div>
  </section>

  <!-- INTESTINO -->
  <section id="sec-intestino" class="section">
    <div class="card">
      <h2>üöΩ Intestino</h2>
      <div class="muted">Marca se foi ao banheiro e se tomou √°gua morna + chia (ajuda a acompanhar).</div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">Hoje eu fui?</label>
          <select id="intSel">
            <option value="nao">N√£o</option>
            <option value="sim">Sim</option>
            <option value="pouco">Pouquinho</option>
          </select>
        </div>
        <div>
          <label class="muted">Chia em jejum?</label>
          <select id="chiaSel">
            <option value="nao">N√£o</option>
            <option value="sim">Sim</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="intSalvar()">Salvar</button>
      </div>

      <div class="card" style="margin:12px 0 0; background: rgba(255,255,255,.05); border-color: rgba(255,255,255,.10);">
        <h2 style="margin:0 0 8px;">üìÜ √öltimos registros</h2>
        <div id="intHist" class="muted"></div>
      </div>

      <div class="note">
        üí° <b>Como fazer:</b> 1 copo de <b>√°gua morna</b> + 1 colher de <b>chia</b> (hidratar 10 min) em jejum.<br/>
        ‚úÖ Se te ajudou sexta e domingo, continue e acompanhe aqui (consist√™ncia).
      </div>
    </div>
  </section>

  <!-- MEDIDAS -->
  <section id="sec-medidas" class="section">
    <div class="card">
      <h2>üìè Medidas</h2>
      <div class="muted">Recomendado: 1x por semana (mesmo hor√°rio). O app calcula propor√ß√£o e nota.</div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">Peso (kg)</label>
          <input type="number" id="mPeso" step="0.1" placeholder="Ex: 56.9" />
        </div>
        <div>
          <label class="muted">Cintura (cm)</label>
          <input type="number" id="mCintura" placeholder="Ex: 72" />
        </div>
      </div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">Abd√¥men (cm)</label>
          <input type="number" id="mAbdomen" placeholder="Ex: 81" />
        </div>
        <div>
          <label class="muted">Gl√∫teo (cm)</label>
          <input type="number" id="mGluteo" placeholder="Ex: 96" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="medSalvar()">Salvar</button>
        <button class="btn secondary" onclick="medExport()">üì§ Exportar (texto)</button>
      </div>

      <div class="card" style="margin:12px 0 0; background: rgba(255,255,255,.05); border-color: rgba(255,255,255,.10);">
        <h2 style="margin:0 0 8px;">üïí √öltima medida</h2>
        <div id="medUlt" class="muted"></div>
      </div>

      <div class="card" style="margin:12px 0 0; background: rgba(255,255,255,.05); border-color: rgba(255,255,255,.10);">
        <h2 style="margin:0 0 8px;">üìú Hist√≥rico</h2>
        <div id="medHist" class="muted"></div>
      </div>
    </div>
  </section>

  <!-- FOTOS -->
  <section id="sec-fotos" class="section">
    <div class="card">
      <h2>üì∏ Fotos (Antes/Depois)</h2>
      <div class="muted">Dica: 1x a cada 14 dias. Mesma luz, mesma pose, mesma dist√¢ncia.</div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">Data da foto</label>
          <input type="date" id="fotoData" />
        </div>
        <div>
          <label class="muted">Tipo</label>
          <select id="fotoTipo">
            <option value="antes">Antes</option>
            <option value="depois">Depois</option>
          </select>
        </div>
      </div>

      <div style="margin-top:10px;">
        <label class="muted">Escolher imagem</label>
        <input type="file" id="fotoFile" accept="image/*" />
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="fotoSalvar()">Salvar foto</button>
        <button class="btn secondary" onclick="fotoLimpar()">üóëÔ∏è Limpar tudo</button>
      </div>

      <div class="photoGrid" id="fotoGrid" style="margin-top:12px;"></div>
      <div class="note">üîí As fotos ficam s√≥ no seu celular (LocalStorage). Se limpar dados do navegador, apaga.</div>
    </div>
  </section>

  <!-- CARGAS -->
  <section id="sec-cargas" class="section">
    <div class="card">
      <h2>üìù Registrar cargas</h2>
      <div class="muted">Escolha dia + exerc√≠cio. Salva peso e reps.</div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">Dia</label>
          <select id="cDia"></select>
        </div>
        <div>
          <label class="muted">Exerc√≠cio</label>
          <select id="cEx"></select>
        </div>
      </div>

      <div class="grid2" style="margin-top:10px;">
        <div>
          <label class="muted">Peso (kg)</label>
          <input type="number" id="cPeso" placeholder="Ex: 18" />
        </div>
        <div>
          <label class="muted">Reps</label>
          <input type="text" id="cReps" placeholder="Ex: 12" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <button class="btn" onclick="cSalvar()">Salvar</button>
        <button class="btn secondary" onclick="cLimpar()">üßπ Limpar dia</button>
      </div>

      <div class="card" style="margin:12px 0 0; background: rgba(255,255,255,.05); border-color: rgba(255,255,255,.10);">
        <h2 style="margin:0 0 8px;">üìå √öltimos registros</h2>
        <div id="cHist" class="muted"></div>
      </div>
    </div>
  </section>

  <!-- PEITO FIRME -->
  <section id="sec-peito" class="section">
    <div class="card">
      <h2>üíó Peito firme (apoio)</h2>
      <div class="muted">O treino n√£o ‚Äúlevanta‚Äù pele sozinho, mas melhora sustenta√ß√£o com peitoral + postura.</div>

      <div class="note">
        ‚úÖ <b>2x por semana</b> (no dia de superior) j√° ajuda muito:<br/>
        ‚Ä¢ Supino inclinado (m√°quina) 3√ó12<br/>
        ‚Ä¢ Crucifixo m√°quina 3√ó12<br/>
        ‚Ä¢ Face pull 3√ó15 (postura/colo)<br/>
        ‚Ä¢ Remada baixa 3√ó12 (costas firmes)<br/>
        <br/>
        üí° Dica: postura faz o peito ‚Äúaparecer‚Äù mais alto.
      </div>
    </div>
  </section>

  <!-- NAV INFERIOR -->
  <div class="nav">
    <div class="navInner">
      <div class="navBtn active" id="nav-inicio" onclick="go('inicio')"><span>üè†</span><small>In√≠cio</small></div>
      <div class="navBtn" id="nav-treino" onclick="go('treino')"><span>üèãÔ∏è‚Äç‚ôÄÔ∏è</span><small>Treino</small></div>
      <div class="navBtn" id="nav-agua" onclick="go('agua')"><span>üíß</span><small>√Ågua</small></div>
      <div class="navBtn" id="nav-medidas" onclick="go('medidas')"><span>üìè</span><small>Medidas</small></div>
      <div class="navBtn" id="nav-fotos" onclick="go('fotos')"><span>üì∏</span><small>Fotos</small></div>
    </div>
  </div>

<script>
/* ==========================
   DADOS (LocalStorage)
========================== */
const KEY = "miria_sculpt_v3";

function hojeISO(){
  return new Date().toISOString().split("T")[0];
}
function fmtBR(iso){
  if(!iso) return "";
  const [y,m,d] = iso.split("-");
  return `${d}/${m}/${y}`;
}
function load(){
  const d = JSON.parse(localStorage.getItem(KEY) || "null");
  return d || {
    agua: {},                 // { "YYYY-MM-DD": {total, pilha[]} }
    proteina: {},             // { "YYYY-MM-DD": {meta, itens:[{food,qtd,prot}]} }
    intestino: {},            // { "YYYY-MM-DD": {foi, chia} }
    medidas: [],              // [{data,peso,cintura,abdomen,gluteo}]
    fotos: [],                // [{data,tipo,src}]
    cargas: {}                // { "SEG": { "exName": {peso,reps,data} } }
  };
}
function save(){
  localStorage.setItem(KEY, JSON.stringify(state));
}
let state = load();

/* ==========================
   TREINO (SEG‚ÄìSEX) + LINKS
========================== */
const TREINO = {
  "SEG": {
    titulo: "Segunda ‚Ä¢ Gl√∫teo / Posterior üçë",
    itens: [
      {n:"1Ô∏è‚É£ Cadeira Flexora", s:"3√ó12", w:"üëâ 20‚Äì25kg", t:"Controle total. Sem tirar o quadril do banco.", v:"https://www.youtube.com/results?search_query=cadeira+flexora+como+fazer+correto"},
      {n:"2Ô∏è‚É£ Stiff com halter", s:"3√ó12", w:"üëâ 6‚Äì8kg cada lado", t:"Coluna neutra. Desce devagar. Sente alongar posterior.", v:"https://www.youtube.com/results?search_query=stiff+com+halter+como+fazer"},
      {n:"3Ô∏è‚É£ Eleva√ß√£o p√©lvica (Hip Thrust)", s:"4√ó10", w:"üëâ 20kg (meta evoluir)", t:"Pausa 1s no topo. N√£o arquear lombar.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+p%C3%A9lvica+como+fazer"},
      {n:"4Ô∏è‚É£ Abdutora m√°quina", s:"3√ó15", w:"üëâ 30‚Äì35kg", t:"Inclina levemente pra frente e segura 1s aberta.", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
      {n:"üö∂‚Äç‚ôÄÔ∏è Cardio (opcional)", s:"12 min", w:"üëâ esteira inclinada", t:"Leve/moderado pra ajudar barriga sem perder gl√∫teo.", v:"https://www.youtube.com/results?search_query=esteira+inclinada+como+fazer"}
    ]
  },
  "TER": {
    titulo: "Ter√ßa ‚Ä¢ Peito + Ombro (colo firme) üíó",
    itens: [
      {n:"1Ô∏è‚É£ Supino inclinado m√°quina", s:"3√ó12", w:"üëâ 15‚Äì20kg", t:"Peito aberto. Ombros pra baixo.", v:"https://www.youtube.com/results?search_query=supino+inclinado+m%C3%A1quina+como+fazer"},
      {n:"2Ô∏è‚É£ Crucifixo m√°quina", s:"3√ó12", w:"üëâ 15kg", t:"Controlado. N√£o esticar demais.", v:"https://www.youtube.com/results?search_query=crucifixo+m%C3%A1quina+como+fazer"},
      {n:"3Ô∏è‚É£ Eleva√ß√£o lateral halter", s:"3√ó12", w:"üëâ 4kg", t:"Sobe at√© linha do ombro. Sem balan√ßar.", v:"https://www.youtube.com/results?search_query=eleva%C3%A7%C3%A3o+lateral+halter+como+fazer"},
      {n:"4Ô∏è‚É£ Desenvolvimento ombro halter", s:"3√ó10", w:"üëâ 6kg", t:"Controle. N√£o jogar a lombar.", v:"https://www.youtube.com/results?search_query=desenvolvimento+ombro+halter+como+fazer"},
      {n:"‚è≥ V√°cuo abdominal", s:"3√ó20s", w:"üëâ cintura marcada", t:"Solta o ar e puxa o umbigo pra dentro.", v:"https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer"}
    ]
  },
  "QUA": {
    titulo: "Quarta ‚Ä¢ Quadr√≠ceps + Gl√∫teo üçë",
    itens: [
      {n:"1Ô∏è‚É£ Leg Press", s:"4√ó12", w:"üëâ 80kg (meta 100‚Äì110kg)", t:"P√© um pouco mais alto. N√£o travar joelho.", v:"https://www.youtube.com/results?search_query=leg+press+como+fazer+correto"},
      {n:"2Ô∏è‚É£ Agachamento no Smith", s:"3√ó10", w:"üëâ 10kg cada lado", t:"P√©s levemente √† frente. Desce controlado.", v:"https://www.youtube.com/results?search_query=agachamento+no+smith+como+fazer"},
      {n:"3Ô∏è‚É£ Cadeira Extensora", s:"3√ó12", w:"üëâ 25kg", t:"Sobe forte e desce controlando.", v:"https://www.youtube.com/results?search_query=cadeira+extensora+como+fazer"},
      {n:"4Ô∏è‚É£ Abdutora", s:"3√ó15", w:"üëâ 30‚Äì35kg", t:"Foco no gl√∫teo lateral (ajuda ampulheta).", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"}
    ]
  },
  "QUI": {
    titulo: "Quinta ‚Ä¢ Costas + Postura üßò‚Äç‚ôÄÔ∏è",
    itens: [
      {n:"1Ô∏è‚É£ Puxada frente", s:"3√ó12", w:"üëâ 25kg", t:"Puxa com cotovelos. Ombros pra baixo.", v:"https://www.youtube.com/results?search_query=puxada+frente+na+polia+como+fazer"},
      {n:"2Ô∏è‚É£ Remada baixa", s:"3√ó12", w:"üëâ 25kg", t:"Segura 1s atr√°s. Postura firme.", v:"https://www.youtube.com/results?search_query=remada+baixa+na+polia+como+fazer"},
      {n:"3Ô∏è‚É£ Face Pull", s:"3√ó15", w:"üëâ leve/m√©dio", t:"Postura e colo bonito. Cotovelos altos.", v:"https://www.youtube.com/results?search_query=face+pull+como+fazer"},
      {n:"4Ô∏è‚É£ Prancha", s:"3√ó40s", w:"üëâ core firme", t:"Barriga pra dentro. Sem cair lombar.", v:"https://www.youtube.com/results?search_query=prancha+abdominal+como+fazer"}
    ]
  },
  "SEX": {
    titulo: "Sexta ‚Ä¢ Gl√∫teo Foco üçë",
    itens: [
      {n:"1Ô∏è‚É£ Eleva√ß√£o p√©lvica (pesado)", s:"4√ó8", w:"üëâ 30kg (meta 45kg)", t:"Forma perfeita. Pausa no topo.", v:"https://www.youtube.com/results?search_query=hip+thrust+como+fazer"},
      {n:"2Ô∏è‚É£ Stiff", s:"3√ó12", w:"üëâ 8kg cada lado", t:"Controle, coluna neutra.", v:"https://www.youtube.com/results?search_query=stiff+com+halter+como+fazer"},
      {n:"3Ô∏è‚É£ Afundo andando", s:"3√ó10 cada perna", w:"üëâ 4‚Äì6kg", t:"Tronco levemente √† frente, calcanhar empurra.", v:"https://www.youtube.com/results?search_query=afundo+andando+como+fazer"},
      {n:"4Ô∏è‚É£ Abdutora", s:"4√ó15", w:"üëâ 35‚Äì40kg", t:"Segura 1s aberta. Gl√∫teo lateral.", v:"https://www.youtube.com/results?search_query=abdutora+m%C3%A1quina+como+usar"},
      {n:"‚è≥ V√°cuo abdominal", s:"3√ó20s", w:"üëâ cintura", t:"Consist√™ncia 3x/semana.", v:"https://www.youtube.com/results?search_query=vacuum+abdominal+como+fazer"}
    ]
  }
};

/* ==========================
   NAVEGA√á√ÉO
========================== */
function go(sec){
  // section
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById("sec-"+sec).classList.add("active");

  // nav
  document.querySelectorAll(".navBtn").forEach(b=>b.classList.remove("active"));
  const navId = "nav-" + sec;
  const el = document.getElementById(navId);
  if(el) el.classList.add("active");

  // telas que precisam renderizar
  if(sec==="inicio"){ renderKPIs(); drawGluteoChart(); }
  if(sec==="treino"){ renderTreino(); }
  if(sec==="agua"){ renderAgua(); }
  if(sec==="proteina"){ renderProt(); }
  if(sec==="intestino"){ renderInt(); }
  if(sec==="medidas"){ renderMed(); renderKPIs(); drawGluteoChart(); }
  if(sec==="fotos"){ renderFotos(); }
  if(sec==="cargas"){ renderCargasUI(); renderCargasHist(); }
  if(sec==="peito"){ /* ok */ }
}

/* ==========================
   √ÅGUA
========================== */
function ensureAguaHoje(){
  const d = hojeISO();
  if(!state.agua[d]) state.agua[d] = { total:0, pilha:[] };
}
function aguaAdd(v){
  ensureAguaHoje();
  state.agua[hojeISO()].total += v;
  state.agua[hojeISO()].pilha.push(v);
  save(); renderAgua();
}
function aguaAddManual(){
  const v = Number(document.getElementById("aguaManual").value||0);
  if(v>0){ aguaAdd(v); document.getElementById("aguaManual").value=""; }
}
function aguaDesfazer(){
  ensureAguaHoje();
  const stack = state.agua[hojeISO()].pilha;
  const last = stack.pop();
  if(last){ state.agua[hojeISO()].total -= last; }
  save(); renderAgua();
}
function aguaZerar(){
  state.agua[hojeISO()] = { total:0, pilha:[] };
  save(); renderAgua();
}
function renderAgua(){
  ensureAguaHoje();
  const meta = Number(document.getElementById("aguaMeta")?.value || 2500);
  const total = state.agua[hojeISO()].total;

  const pct = Math.min(100, Math.round((total/meta)*100));
  document.getElementById("aguaBar").style.width = pct + "%";
  document.getElementById("aguaHoje").innerText = total + " ml";

  // m√©dia 7 dias
  let soma=0, dias=0;
  for(let i=0;i<7;i++){
    const d = new Date();
    d.setDate(d.getDate()-i);
    const key = d.toISOString().split("T")[0];
    if(state.agua[key]){
      soma += state.agua[key].total;
      dias++;
    }
  }
  const media = dias ? Math.round(soma/dias) : 0;
  document.getElementById("aguaMedia7").innerText = media + " ml";
}

/* ==========================
   PROTE√çNA (AUTOM√ÅTICA)
========================== */
const fatores = {
  frango: { tipo:"g", por:100, prot:31 },
  carne:  { tipo:"g", por:100, prot:26 },
  ovo:    { tipo:"un", por:1,   prot:6  },
  iog:    { tipo:"un", por:1,   prot:10 },
  queijo: { tipo:"g", por:100, prot:25 },
  whey:   { tipo:"sc", por:1,   prot:20 }
};
function ensureProtHoje(){
  const d = hojeISO();
  if(!state.proteina[d]) state.proteina[d] = { meta: 100, itens: [], pilha: [] };
}
function calcProt(food, qtd){
  const cfg = fatores[food];
  qtd = Number(qtd||0);
  if(!cfg || qtd<=0) return 0;
  if(cfg.por===1) return qtd * cfg.prot;
  return (qtd / cfg.por) * cfg.prot;
}
function protAdd(){
  ensureProtHoje();
  const d = hojeISO();
  const food = document.getElementById("protFood").value;
  const qtd = Number(document.getElementById("protQtd").value||0);
  if(qtd<=0) return;

  const p = Math.round(calcProt(food, qtd));
  state.proteina[d].meta = Number(document.getElementById("protMeta").value||100);
  state.proteina[d].itens.push({ food, qtd, prot:p });
  state.proteina[d].pilha.push({ food, qtd, prot:p });

  save();
  document.getElementById("protQtd").value="";
  renderProt();
}
function protDesfazer(){
  ensureProtHoje();
  const d = hojeISO();
  const last = state.proteina[d].pilha.pop();
  if(last){
    // remove √∫ltimo item correspondente
    for(let i=state.proteina[d].itens.length-1;i>=0;i--){
      const it = state.proteina[d].itens[i];
      if(it.food===last.food && it.qtd===last.qtd && it.prot===last.prot){
        state.proteina[d].itens.splice(i,1);
        break;
      }
    }
  }
  save(); renderProt();
}
function protZerar(){
  state.proteina[hojeISO()] = { meta: Number(document.getElementById("protMeta")?.value||100), itens:[], pilha:[] };
  save(); renderProt();
}
function renderProt(){
  ensureProtHoje();
  const d = hojeISO();
  document.getElementById("protData").value = fmtBR(d);

  const meta = Number(document.getElementById("protMeta").value||100);
  state.proteina[d].meta = meta;

  const total = state.proteina[d].itens.reduce((a,b)=>a+Number(b.prot||0),0);
  const faltam = Math.max(0, meta - total);

  document.getElementById("protHoje").innerText = total + " g";
  document.getElementById("protFaltam").innerText = faltam + " g";
  const pct = Math.min(100, Math.round((total/meta)*100));
  document.getElementById("protBar").style.width = pct + "%";

  const nomeFood = (f)=>{
    if(f==="frango") return "üçó Frango";
    if(f==="carne") return "ü•© Carne";
    if(f==="ovo") return "ü•ö Ovo";
    if(f==="iog") return "ü•õ Iogurte";
    if(f==="queijo") return "üßÄ Queijo";
    if(f==="whey") return "ü•§ Whey";
    return f;
  };
  const unit = (f)=>{
    const t = fatores[f]?.tipo;
    if(t==="g") return "g";
    if(t==="un") return "un";
    if(t==="sc") return "scoop";
    return "";
  };

  const html = state.proteina[d].itens.length
    ? state.proteina[d].itens.map(it=> `‚Ä¢ ${nomeFood(it.food)}: <b>${it.qtd}${unit(it.food)}</b> ‚Üí <b>${it.prot}g</b>`).join("<br>")
    : "Sem itens ainda.";

  document.getElementById("protLista").innerHTML = html;
  save();
}

/* ==========================
   INTESTINO
========================== */
function intSalvar(){
  const d = hojeISO();
  state.intestino[d] = {
    foi: document.getElementById("intSel").value,
    chia: document.getElementById("chiaSel").value
  };
  save(); renderInt();
}
function renderInt(){
  const d = hojeISO();
  if(state.intestino[d]){
    document.getElementById("intSel").value = state.intestino[d].foi;
    document.getElementById("chiaSel").value = state.intestino[d].chia;
  }else{
    document.getElementById("intSel").value = "nao";
    document.getElementById("chiaSel").value = "nao";
  }
  // √∫ltimos 10
  const entries = Object.entries(state.intestino)
    .sort((a,b)=>a[0].localeCompare(b[0]))
    .slice(-10);

  const txt = entries.length
    ? entries.map(([data,val])=>{
        const foiTxt = val.foi==="sim" ? "‚úÖ Sim" : (val.foi==="pouco" ? "üü° Pouquinho" : "‚ùå N√£o");
        const chiaTxt = val.chia==="sim" ? " + üåø chia" : "";
        return `<b>${fmtBR(data)}</b> ‚Äî ${foiTxt}${chiaTxt}`;
      }).join("<br>")
    : "Sem registros ainda.";

  document.getElementById("intHist").innerHTML = txt;
}

/* ==========================
   MEDIDAS + KPI + CHART
========================== */
function ratioNota(cintura, gluteo){
  cintura = Number(cintura||0);
  gluteo = Number(gluteo||0);
  if(!cintura || !gluteo) return {ratio:null, nota:"‚Äî"};
  const r = gluteo / cintura; // ex: 96/72=1.33
  let nota = "Natural";
  if(r >= 1.30) nota = "Ampulheta ‚≠ê";
  if(r >= 1.35) nota = "Ampulheta PRO ‚ú®";
  return {ratio:r, nota};
}

function medSalvar(){
  const item = {
    data: hojeISO(),
    peso: Number(document.getElementById("mPeso").value||0),
    cintura: Number(document.getElementById("mCintura").value||0),
    abdomen: Number(document.getElementById("mAbdomen").value||0),
    gluteo: Number(document.getElementById("mGluteo").value||0)
  };
  state.medidas.push(item);
  save();
  renderMed();
  renderKPIs();
  drawGluteoChart();
}
function renderMed(){
  if(!state.medidas.length){
    document.getElementById("medUlt").innerHTML = "Sem medidas ainda.";
    document.getElementById("medHist").innerHTML = "";
    return;
  }
  const ult = state.medidas[state.medidas.length-1];
  const rn = ratioNota(ult.cintura, ult.gluteo);

  document.getElementById("medUlt").innerHTML =
    `<b>${fmtBR(ult.data)}</b><br>
     Peso: <b>${ult.peso || "‚Äî"}</b> kg<br>
     Cintura: <b>${ult.cintura || "‚Äî"}</b> cm ‚Ä¢ Abd√¥men: <b>${ult.abdomen || "‚Äî"}</b> cm ‚Ä¢ Gl√∫teo: <b>${ult.gluteo || "‚Äî"}</b> cm<br>
     Propor√ß√£o: <b>${rn.ratio ? rn.ratio.toFixed(2) : "‚Äî"}</b> ‚Ä¢ Nota: <b>${rn.nota}</b>`;

  const hist = state.medidas.slice(-12).map(m=>{
    const rr = ratioNota(m.cintura, m.gluteo);
    return `‚Ä¢ <b>${fmtBR(m.data)}</b> ‚Äî Cint ${m.cintura} | Gl√∫t ${m.gluteo} | Ratio ${rr.ratio?rr.ratio.toFixed(2):"‚Äî"}`;
  }).join("<br>");

  document.getElementById("medHist").innerHTML = hist;
}
function medExport(){
  if(!state.medidas.length) return alert("Ainda n√£o tem medidas salvas.");
  const lines = state.medidas.map(m=>{
    const r = ratioNota(m.cintura, m.gluteo);
    return `${m.data} | Peso ${m.peso} | Cint ${m.cintura} | Abd ${m.abdomen} | Gl√∫t ${m.gluteo} | Ratio ${r.ratio? r.ratio.toFixed(2):"‚Äî"}`;
  }).join("\n");
  navigator.clipboard?.writeText(lines);
  alert("Copiado! (Se n√£o copiar, selecione e copie manualmente no navegador.)");
}

function renderKPIs(){
  const ult = state.medidas[state.medidas.length-1];
  if(!ult){
    document.getElementById("kpiRatio").innerText = "‚Äî";
    document.getElementById("kpiNota").innerText = "‚Äî";
    return;
  }
  const rn = ratioNota(ult.cintura, ult.gluteo);
  document.getElementById("kpiRatio").innerText = rn.ratio ? rn.ratio.toFixed(2) : "‚Äî";
  document.getElementById("kpiNota").innerText = rn.nota;
}

function drawGluteoChart(){
  const c = document.getElementById("chartGluteo");
  if(!c) return;
  const ctx = c.getContext("2d");
  ctx.clearRect(0,0,c.width,c.height);

  const data = state.medidas.slice(-10).filter(m=>Number(m.gluteo||0)>0);
  if(data.length < 2){
    ctx.fillStyle = "rgba(244,244,247,.70)";
    ctx.font = "14px system-ui";
    ctx.fillText("Salve pelo menos 2 medidas de gl√∫teo para ver o gr√°fico.", 16, 40);
    return;
  }

  // ajustar para canvas real
  const w = c.width = c.clientWidth * devicePixelRatio;
  const h = c.height = 240 * devicePixelRatio;

  const pad = 22 * devicePixelRatio;
  const xs = data.map((_,i)=> i);
  const ys = data.map(m=> Number(m.gluteo));

  const minY = Math.min(...ys) - 1;
  const maxY = Math.max(...ys) + 1;

  function X(i){ return pad + (i/(xs.length-1))*(w-2*pad); }
  function Y(v){ return (h-pad) - ((v-minY)/(maxY-minY))*(h-2*pad); }

  // grid
  ctx.strokeStyle = "rgba(255,255,255,.10)";
  ctx.lineWidth = 1 * devicePixelRatio;
  for(let i=0;i<4;i++){
    const y = pad + i*((h-2*pad)/3);
    ctx.beginPath(); ctx.moveTo(pad,y); ctx.lineTo(w-pad,y); ctx.stroke();
  }

  // line
  ctx.strokeStyle = "rgba(240,216,155,.95)";
  ctx.lineWidth = 3 * devicePixelRatio;
  ctx.beginPath();
  ys.forEach((v,i)=>{
    const x = X(i), y = Y(v);
    if(i===0) ctx.moveTo(x,y); else ctx.lineTo(x,y);
  });
  ctx.stroke();

  // points
  ys.forEach((v,i)=>{
    const x = X(i), y = Y(v);
    ctx.fillStyle = "rgba(255,62,142,.95)";
    ctx.beginPath(); ctx.arc(x,y,4.5*devicePixelRatio,0,Math.PI*2); ctx.fill();
  });

  // labels
  ctx.fillStyle = "rgba(244,244,247,.85)";
  ctx.font = `${12*devicePixelRatio}px system-ui`;
  ctx.fillText(`Gl√∫teo (cm)`, pad, pad-6*devicePixelRatio);

  // last value
  const last = ys[ys.length-1];
  ctx.fillStyle = "rgba(244,244,247,.92)";
  ctx.font = `${14*devicePixelRatio}px system-ui`;
  ctx.fillText(`√öltimo: ${last} cm`, pad, h - (pad/2));
}

/* ==========================
   TREINO RENDER (tabs SEG‚ÄìSEX)
========================== */
let diaAtivo = "SEG";

function renderTabs(){
  const cont = document.getElementById("tabsDias");
  cont.innerHTML = "";
  ["SEG","TER","QUA","QUI","SEX"].forEach(d=>{
    const b = document.createElement("div");
    b.className = "tab" + (d===diaAtivo ? " active" : "");
    b.innerText = d;
    b.onclick = ()=>{ diaAtivo=d; renderTreino(); };
    cont.appendChild(b);
  });
}

function renderTreino(){
  renderTabs();
  const box = document.getElementById("treinoLista");
  const dia = TREINO[diaAtivo];
  box.innerHTML = `
    <div class="ex" style="background: rgba(255,255,255,.06);">
      <div class="muted"><b>${dia.titulo}</b><br>Toque em <b>‚ÄúVer v√≠deo (PT)‚Äù</b> para ver execu√ß√£o correta.</div>
    </div>
  `;

  dia.itens.forEach((it,idx)=>{
    const reg = (state.cargas[diaAtivo] && state.cargas[diaAtivo][it.n]) ? state.cargas[diaAtivo][it.n] : null;
    const right = reg ? `‚úÖ ${reg.peso}kg ‚Ä¢ ${reg.reps} reps` : `Sem registro ainda`;

    const div = document.createElement("div");
    div.className = "ex";
    div.innerHTML = `
      <div class="exTop">
        <div>
          <div class="exName">${it.n}</div>
          <div class="exMeta">${it.s} ‚Ä¢ ${it.w}</div>
        </div>
        <div class="muted" style="font-weight:800;">${right}</div>
      </div>
      <div class="exTip">üí° ${it.t}</div>
      <a href="${it.v}" target="_blank" rel="noopener">‚ñ∂ Ver v√≠deo (PT)</a>
    `;
    box.appendChild(div);
  });

  // tamb√©m atualiza selects de cargas
  renderCargasUI();
}

/* ==========================
   CARGAS
========================== */
function renderCargasUI(){
  const sd = document.getElementById("cDia");
  const se = document.getElementById("cEx");
  if(!sd || !se) return;

  sd.innerHTML = "";
  ["SEG","TER","QUA","QUI","SEX"].forEach(d=>{
    const opt = document.createElement("option");
    opt.value = d; opt.textContent = d;
    sd.appendChild(opt);
  });
  sd.value = diaAtivo;

  function fillEx(){
    se.innerHTML = "";
    TREINO[sd.value].itens.forEach(it=>{
      const opt = document.createElement("option");
      opt.value = it.n; opt.textContent = it.n;
      se.appendChild(opt);
    });
  }
  fillEx();
  sd.onchange = fillEx;
}
function cSalvar(){
  const dia = document.getElementById("cDia").value;
  const ex = document.getElementById("cEx").value;
  const peso = Number(document.getElementById("cPeso").value||0);
  const reps = (document.getElementById("cReps").value||"").trim();
  if(!peso || !reps) return alert("Preencha peso e reps.");

  if(!state.cargas[dia]) state.cargas[dia] = {};
  state.cargas[dia][ex] = { peso, reps, data: hojeISO() };

  save();
  renderTreino();
  renderCargasHist();
  alert("Salvo ‚úÖ");
}
function cLimpar(){
  const dia = document.getElementById("cDia").value;
  state.cargas[dia] = {};
  save();
  renderTreino();
  renderCargasHist();
}
function renderCargasHist(){
  const el = document.getElementById("cHist");
  if(!el) return;

  let rows = [];
  ["SEG","TER","QUA","QUI","SEX"].forEach(d=>{
    const obj = state.cargas[d] || {};
    Object.entries(obj).forEach(([ex,v])=>{
      rows.push(`‚Ä¢ <b>${d}</b> ‚Äî ${ex}: <b>${v.peso}kg</b> ‚Ä¢ <b>${v.reps}</b> (${fmtBR(v.data)})`);
    });
  });
  el.innerHTML = rows.length ? rows.slice(-12).join("<br>") : "Sem registros ainda.";
}

/* ==========================
   FOTOS (LocalStorage)
========================== */
function fotoSalvar(){
  const data = document.getElementById("fotoData").value || hojeISO();
  const tipo = document.getElementById("fotoTipo").value;
  const file = document.getElementById("fotoFile").files[0];
  if(!file) return alert("Escolha uma imagem.");

  const reader = new FileReader();
  reader.onload = ()=>{
    state.fotos.unshift({ data, tipo, src: reader.result });
    save(); renderFotos();
    document.getElementById("fotoFile").value="";
    alert("Foto salva ‚úÖ");
  };
  reader.readAsDataURL(file);
}
function fotoLimpar(){
  if(confirm("Tem certeza que quer apagar TODAS as fotos salvas no app?")){
    state.fotos = [];
    save(); renderFotos();
  }
}
function renderFotos(){
  const grid = document.getElementById("fotoGrid");
  if(!grid) return;

  grid.innerHTML = "";
  if(!state.fotos.length){
    grid.innerHTML = `<div class="muted">Sem fotos ainda.</div>`;
    return;
  }
  state.fotos.slice(0,10).forEach(p=>{
    const div = document.createElement("div");
    div.className = "photoCard";
    div.innerHTML = `
      <img src="${p.src}" alt="foto" />
      <div class="photoMeta"><b>${p.tipo.toUpperCase()}</b> ‚Ä¢ ${fmtBR(p.data)}</div>
    `;
    grid.appendChild(div);
  });
}

/* ==========================
   BOOT
========================== */
function init(){
  // defaults UI
  document.getElementById("protData").value = fmtBR(hojeISO());

  // Render inicial
  renderKPIs();
  drawGluteoChart();
  renderTreino();
  renderAgua();
  renderProt();
  renderInt();
  renderMed();
  renderFotos();
  renderCargasHist();

  // Service Worker (PWA)
  if("serviceWorker" in navigator){
    navigator.serviceWorker.register("./sw.js").catch(()=>{});
  }
}
init();
</script>
</body>
</html>
